<!DOCTYPE html> <html lang="zh-CN"> <head> <link rel="preload" href="/assets/css/main.css" as="style"> <link rel="preload" href="/assets/js/main.js" as="script"> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>AlingAi Pro - API连接测试</title> <style> body { font-family: 'Microsoft YaHei', sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; } .container { max-width: 1200px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); } h1 { text-align: center; color: #333; margin-bottom: 30px; } .test-section { margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #667eea; } .test-title { font-size: 1.2rem; font-weight: 600; color: #333; margin-bottom: 15px; } .test-result { padding: 15px; border-radius: 8px; margin-top: 10px; font-family: 'Courier New', monospace; white-space: pre-wrap; max-height: 300px; overflow-y: auto; } .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; } .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; } .loading { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; } .btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; margin-right: 10px; transition: transform 0.2s ease; } .btn:hover { transform: translateY(-2px); } .btn:disabled { background: #ccc; cursor: not-allowed; transform: none; } </style> 
        <style>
            @media (max-width: 768px) {
                .container { width: 100%; padding: 0 15px; }
                .row { flex-direction: column; }
                .col { width: 100%; }
            }
            @media (max-width: 480px) {
                body { font-size: 14px; }
                h1 { font-size: 24px; }
                h2 { font-size: 20px; }
            }
        </style></head> <body> <div class="container"> <h1>🚀 AlingAi Pro API连接测试</h1> <div class="test-section"> <div class="test-title">📊 系统统计测试</div> <button class="btn" onclick="testStats()">测试统计接口</button> <div id="stats-result" class="test-result loading">点击按钮开始测试...</div> </div> <div class="test-section"> <div class="test-title">👥 用户管理测试</div> <button class="btn" onclick="testUsers()">测试用户接口</button> <button class="btn" onclick="testEnterpriseUsers()">测试企业用户</button> <div id="users-result" class="test-result loading">点击按钮开始测试...</div> </div> <div class="test-section"> <div class="test-title">📋 申请管理测试</div> <button class="btn" onclick="testApplications()">测试申请接口</button> <button class="btn" onclick="testPendingApplications()">测试待审核申请</button> <div id="applications-result" class="test-result loading">点击按钮开始测试...</div> </div> <div class="test-section"> <div class="test-title">⚙️ 完整功能测试</div> <button class="btn" onclick="runComprehensiveTest()">运行完整测试</button> <div id="comprehensive-result" class="test-result loading">点击按钮开始完整测试...</div> </div> </div> <script> const API_BASE_URL = 'http://localhost:8080/api/admin'; async function testApiEndpoint(endpoint, method = 'GET', data = null) { try { const options = { method: method, headers: { 'Content-Type': 'application/json', } }; if (data) { options.body = JSON.stringify(data); } const response = await fetch(`${API_BASE_URL}${endpoint}`, options); const result = await response.json(); return { success: response.ok && result.success, status: response.status, data: result }; } catch (error) { return { success: false, error: error.message }; } } async function testStats() { const resultDiv = document.getElementById('stats-result'); resultDiv.className = 'test-result loading'; resultDiv.textContent = '正在测试统计接口...'; const result = await testApiEndpoint('/stats'); if (result.success) { resultDiv.className = 'test-result success'; resultDiv.textContent = `✅ 统计接口测试成功！ 统计数据： • 总用户数: ${result.data.data.total_users} • 企业用户: ${result.data.data.enterprise_users} • 个人用户: ${result.data.data.individual_users} • 总申请数: ${result.data.data.total_applications} • 待审核: ${result.data.data.pending_applications} • 已通过: ${result.data.data.approved_applications} • 总API调用: ${result.data.data.total_api_calls} • 总Token数: ${result.data.data.total_tokens}`; } else { resultDiv.className = 'test-result error'; resultDiv.textContent = `❌ 统计接口测试失败！ 错误信息: ${result.error || JSON.stringify(result.data, null, 2)}`; } } async function testUsers() { const resultDiv = document.getElementById('users-result'); resultDiv.className = 'test-result loading'; resultDiv.textContent = '正在测试用户接口...'; const result = await testApiEndpoint('/users'); if (result.success) { resultDiv.className = 'test-result success'; const users = result.data.data; resultDiv.textContent = `✅ 用户接口测试成功！ 用户列表 (${users.length} 个用户): ${users.map(user => `• ${user.username} (${user.email}) - ${user.user_type || 'individual'} - ${user.status}` ).join('\n')}`; } else { resultDiv.className = 'test-result error'; resultDiv.textContent = `❌ 用户接口测试失败！ 错误信息: ${result.error || JSON.stringify(result.data, null, 2)}`; } } async function testEnterpriseUsers() { const resultDiv = document.getElementById('users-result'); resultDiv.className = 'test-result loading'; resultDiv.textContent = '正在测试企业用户接口...'; const result = await testApiEndpoint('/users?type=enterprise'); if (result.success) { resultDiv.className = 'test-result success'; const users = result.data.data; resultDiv.textContent = `✅ 企业用户接口测试成功！ 企业用户列表 (${users.length} 个用户): ${users.map(user => `• ${user.username} (${user.email}) - ${user.status}` ).join('\n')}`; } else { resultDiv.className = 'test-result error'; resultDiv.textContent = `❌ 企业用户接口测试失败！ 错误信息: ${result.error || JSON.stringify(result.data, null, 2)}`; } } async function testApplications() { const resultDiv = document.getElementById('applications-result'); resultDiv.className = 'test-result loading'; resultDiv.textContent = '正在测试申请接口...'; const result = await testApiEndpoint('/applications'); if (result.success) { resultDiv.className = 'test-result success'; const applications = result.data.data; resultDiv.textContent = `✅ 申请接口测试成功！ 申请列表 (${applications.length} 个申请): ${applications.map(app => `• ${app.company_name} - ${app.contact_person} - ${app.status}` ).join('\n')}`; } else { resultDiv.className = 'test-result error'; resultDiv.textContent = `❌ 申请接口测试失败！ 错误信息: ${result.error || JSON.stringify(result.data, null, 2)}`; } } async function testPendingApplications() { const resultDiv = document.getElementById('applications-result'); resultDiv.className = 'test-result loading'; resultDiv.textContent = '正在测试待审核申请接口...'; const result = await testApiEndpoint('/applications?status=pending'); if (result.success) { resultDiv.className = 'test-result success'; const applications = result.data.data; resultDiv.textContent = `✅ 待审核申请接口测试成功！ 待审核申请 (${applications.length} 个): ${applications.map(app => `• ${app.company_name} - ${app.contact_person} - 申请时间: ${app.created_at}` ).join('\n')}`; } else { resultDiv.className = 'test-result error'; resultDiv.textContent = `❌ 待审核申请接口测试失败！ 错误信息: ${result.error || JSON.stringify(result.data, null, 2)}`; } } async function runComprehensiveTest() { const resultDiv = document.getElementById('comprehensive-result'); resultDiv.className = 'test-result loading'; resultDiv.textContent = '正在运行完整功能测试...'; const tests = [ { name: '系统统计', endpoint: '/stats' }, { name: '用户列表', endpoint: '/users' }, { name: '企业用户', endpoint: '/users?type=enterprise' }, { name: '申请列表', endpoint: '/applications' }, { name: '待审核申请', endpoint: '/applications?status=pending' }, { name: '用户详情', endpoint: '/users/details?userId=2' }, { name: '企业配置', endpoint: '/enterprise-config?userId=2' } ]; const results = []; for (const test of tests) { const result = await testApiEndpoint(test.endpoint); results.push({ name: test.name, success: result.success, data: result.data }); } const successCount = results.filter(r => r.success).length; const totalCount = results.length; if (successCount === totalCount) { resultDiv.className = 'test-result success'; resultDiv.textContent = `🎉 完整功能测试通过！ 测试结果: ${successCount}/${totalCount} 个接口正常 详细结果: ${results.map(r => `${r.success ? '✅' : '❌'} ${r.name}` ).join('\n')}`; } else { resultDiv.className = 'test-result error'; resultDiv.textContent = `⚠️ 部分功能测试失败 测试结果: ${successCount}/${totalCount} 个接口正常 详细结果: ${results.map(r => `${r.success ? '✅' : '❌'} ${r.name}${!r.success ? ' - 失败' : ''}` ).join('\n')}`; } } // 页面加载时自动运行基础测试 window.onload = function() { setTimeout(() => { testStats(); }, 1000); }; </script> </body> </html> 