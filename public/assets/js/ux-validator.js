 class UserExperienceValidator { constructor() { this.testResults = []; this.userFlows = []; this.currentStep = 0; this.isRunning = false; } log(message, type = 'info') { const timestamp = new Date().toLocaleTimeString(); const colors = { 'info': 'color: blue', 'success': 'color: green; font-weight: bold', 'error': 'color: red; font-weight: bold', 'warn': 'color: orange; font-weight: bold', 'user': 'color: purple; font-weight: bold' };  this.testResults.push({ timestamp, message, type, step: this.currentStep }); } async sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms)); } // æµ‹è¯•ç”¨æˆ·æµç¨‹1ï¼šé¦–æ¬¡è®¿é—® async testFirstTimeVisit() { this.log('ğŸš€ å¼€å§‹æµ‹è¯•ï¼šé¦–æ¬¡è®¿é—®ç”¨æˆ·æµç¨‹', 'user'); this.currentStep = 1; try { // æ­¥éª¤1ï¼šé¡µé¢åŠ è½½æ£€æŸ¥ this.log('æ­¥éª¤1ï¼šæ£€æŸ¥é¡µé¢åŠ è½½çŠ¶æ€', 'info'); await this.sleep(1000); const chatContainer = document.getElementById('chatContainer'); const messageInput = document.getElementById('messageInput'); const sendButton = document.getElementById('sendButton'); if (!chatContainer || !messageInput || !sendButton) { throw new Error('å…³é”®UIå…ƒç´ ç¼ºå¤±'); } this.log('âœ… é¡µé¢åŸºæœ¬å…ƒç´ åŠ è½½æ­£å¸¸', 'success'); // æ­¥éª¤2ï¼šæ£€æŸ¥ç™»å½•æ¨¡æ€æ¡† this.log('æ­¥éª¤2ï¼šæ£€æŸ¥ç™»å½•æµç¨‹', 'info'); await this.sleep(500); const loginModal = document.getElementById('loginModal'); const guestModeBtn = document.getElementById('guestModeBtn'); if (loginModal && guestModeBtn) { this.log('âœ… ç™»å½•æ¨¡æ€æ¡†å­˜åœ¨', 'success'); // æ¨¡æ‹Ÿç‚¹å‡»è®¿å®¢æ¨¡å¼ this.log('ğŸ–±ï¸ æ¨¡æ‹Ÿç‚¹å‡»è®¿å®¢æ¨¡å¼æŒ‰é’®', 'user'); guestModeBtn.click(); await this.sleep(1000); const guestMode = localStorage.getItem('guestMode'); if (guestMode === 'true') { this.log('âœ… è®¿å®¢æ¨¡å¼æ¿€æ´»æˆåŠŸ', 'success'); } else { this.log('âš ï¸ è®¿å®¢æ¨¡å¼å¯èƒ½æœªæ­£ç¡®è®¾ç½®', 'warn'); } } else { this.log('âš ï¸ ç™»å½•æ¨¡æ€æ¡†æˆ–è®¿å®¢æŒ‰é’®ä¸å­˜åœ¨', 'warn'); } // æ­¥éª¤3ï¼šæµ‹è¯•åŸºæœ¬èŠå¤©åŠŸèƒ½ await this.testBasicChatFlow(); return true; } catch (error) { this.log(`âŒ é¦–æ¬¡è®¿é—®æµç¨‹å¤±è´¥: ${error.message}`, 'error'); return false; } } // æµ‹è¯•åŸºæœ¬èŠå¤©æµç¨‹ async testBasicChatFlow() { this.log('æ­¥éª¤3ï¼šæµ‹è¯•åŸºæœ¬èŠå¤©åŠŸèƒ½', 'info'); this.currentStep = 3; const messageInput = document.getElementById('messageInput'); const sendButton = document.getElementById('sendButton'); const chatContainer = document.getElementById('chatContainer'); if (!messageInput || !sendButton || !chatContainer) { throw new Error('èŠå¤©ç»„ä»¶ä¸å®Œæ•´'); } // è®°å½•åˆå§‹æ¶ˆæ¯æ•°é‡ const initialMessageCount = chatContainer.querySelectorAll('.message').length; this.log(`åˆå§‹æ¶ˆæ¯æ•°é‡: ${initialMessageCount}`, 'info'); // æµ‹è¯•æ¶ˆæ¯1ï¼šç®€å•æ–‡æœ¬ this.log('ğŸ–±ï¸ å‘é€æµ‹è¯•æ¶ˆæ¯1: "ä½ å¥½"', 'user'); messageInput.value = 'ä½ å¥½'; await this.sleep(500); sendButton.click(); await this.sleep(2000); // ç­‰å¾…å“åº” let currentMessageCount = chatContainer.querySelectorAll('.message').length; if (currentMessageCount > initialMessageCount) { this.log('âœ… æ¶ˆæ¯1å‘é€æˆåŠŸï¼Œç•Œé¢æœ‰æ›´æ–°', 'success'); } else { this.log('âš ï¸ æ¶ˆæ¯1å¯èƒ½æ²¡æœ‰æ­£ç¡®æ˜¾ç¤º', 'warn'); } // æµ‹è¯•æ¶ˆæ¯2ï¼šåŒ…å«æ ¼å¼çš„æ–‡æœ¬ this.log('ğŸ–±ï¸ å‘é€æµ‹è¯•æ¶ˆæ¯2: åŒ…å«**ç²—ä½“**çš„æ¶ˆæ¯', 'user'); messageInput.value = 'è¿™æ˜¯ä¸€æ¡åŒ…å«**ç²—ä½“**å’Œ`ä»£ç `çš„æµ‹è¯•æ¶ˆæ¯'; await this.sleep(500); sendButton.click(); await this.sleep(2000); const finalMessageCount = chatContainer.querySelectorAll('.message').length; if (finalMessageCount > currentMessageCount) { this.log('âœ… æ¶ˆæ¯2å‘é€æˆåŠŸï¼ŒMarkdownæ ¼å¼æµ‹è¯•å®Œæˆ', 'success'); } else { this.log('âš ï¸ æ¶ˆæ¯2å¯èƒ½æ²¡æœ‰æ­£ç¡®æ˜¾ç¤º', 'warn'); } // æ£€æŸ¥æ¶ˆæ¯æ ¼å¼ const messages = chatContainer.querySelectorAll('.message'); let formattedMessagesFound = 0; messages.forEach(msg => { if (msg.innerHTML.includes('<strong>') || msg.innerHTML.includes('<code>')) { formattedMessagesFound++; } }); if (formattedMessagesFound > 0) { this.log('âœ… å‘ç°æ ¼å¼åŒ–æ¶ˆæ¯ï¼ŒMarkdownå¤„ç†æ­£å¸¸', 'success'); } else { this.log('âš ï¸ æœªå‘ç°æ ¼å¼åŒ–æ¶ˆæ¯ï¼ŒMarkdownå¤„ç†å¯èƒ½æœ‰é—®é¢˜', 'warn'); } // æµ‹è¯•å›è½¦å‘é€ this.log('ğŸ–±ï¸ æµ‹è¯•å›è½¦é”®å‘é€åŠŸèƒ½', 'user'); messageInput.value = 'å›è½¦é”®æµ‹è¯•æ¶ˆæ¯'; await this.sleep(500); // æ¨¡æ‹Ÿå›è½¦é”® const enterEvent = new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', which: 13, keyCode: 13 }); messageInput.dispatchEvent(enterEvent); await this.sleep(2000); const afterEnterCount = chatContainer.querySelectorAll('.message').length; if (afterEnterCount > finalMessageCount) { this.log('âœ… å›è½¦é”®å‘é€åŠŸèƒ½æ­£å¸¸', 'success'); } else { this.log('âš ï¸ å›è½¦é”®å‘é€åŠŸèƒ½å¯èƒ½æœ‰é—®é¢˜', 'warn'); } } // æµ‹è¯•UIäº¤äº’åŠŸèƒ½ async testUIInteractions() { this.log('ğŸ§ª æµ‹è¯•UIäº¤äº’åŠŸèƒ½', 'user'); this.currentStep = 4; try { // æµ‹è¯•è®¾ç½®æŒ‰é’® const settingsBtn = document.getElementById('settingsBtn'); if (settingsBtn) { this.log('ğŸ–±ï¸ æµ‹è¯•è®¾ç½®æŒ‰é’®', 'user'); settingsBtn.click(); await this.sleep(1000); this.log('âœ… è®¾ç½®æŒ‰é’®å¯ç‚¹å‡»', 'success'); } else { this.log('âš ï¸ è®¾ç½®æŒ‰é’®ä¸å­˜åœ¨', 'warn'); } // æµ‹è¯•å†å²æŒ‰é’® const historyBtn = document.getElementById('historyBtn'); if (historyBtn) { this.log('ğŸ–±ï¸ æµ‹è¯•å†å²æŒ‰é’®', 'user'); historyBtn.click(); await this.sleep(1000); this.log('âœ… å†å²æŒ‰é’®å¯ç‚¹å‡»', 'success'); } else { this.log('âš ï¸ å†å²æŒ‰é’®ä¸å­˜åœ¨', 'warn'); } // æµ‹è¯•è¯­è¨€åˆ‡æ¢æŒ‰é’® const languageBtn = document.getElementById('languageBtn'); if (languageBtn) { this.log('ğŸ–±ï¸ æµ‹è¯•è¯­è¨€åˆ‡æ¢æŒ‰é’®', 'user'); languageBtn.click(); await this.sleep(1000); this.log('âœ… è¯­è¨€åˆ‡æ¢æŒ‰é’®å¯ç‚¹å‡»', 'success'); } else { this.log('âš ï¸ è¯­è¨€åˆ‡æ¢æŒ‰é’®ä¸å­˜åœ¨', 'warn'); } return true; } catch (error) { this.log(`âŒ UIäº¤äº’æµ‹è¯•å¤±è´¥: ${error.message}`, 'error'); return false; } } // æµ‹è¯•é”™è¯¯å¤„ç† async testErrorHandling() { this.log('ğŸ§ª æµ‹è¯•é”™è¯¯å¤„ç†æœºåˆ¶', 'user'); this.currentStep = 5; try { // æµ‹è¯•ç©ºæ¶ˆæ¯å‘é€ this.log('ğŸ–±ï¸ æµ‹è¯•å‘é€ç©ºæ¶ˆæ¯', 'user'); const messageInput = document.getElementById('messageInput'); const sendButton = document.getElementById('sendButton'); messageInput.value = ''; sendButton.click(); await this.sleep(1000); this.log('âœ… ç©ºæ¶ˆæ¯å¤„ç†æµ‹è¯•å®Œæˆ', 'success'); // æµ‹è¯•æé•¿æ¶ˆæ¯ this.log('ğŸ–±ï¸ æµ‹è¯•å‘é€æé•¿æ¶ˆæ¯', 'user'); const longMessage = 'A'.repeat(10000); messageInput.value = longMessage; sendButton.click(); await this.sleep(2000); this.log('âœ… é•¿æ¶ˆæ¯å¤„ç†æµ‹è¯•å®Œæˆ', 'success'); return true; } catch (error) { this.log(`âŒ é”™è¯¯å¤„ç†æµ‹è¯•å¤±è´¥: ${error.message}`, 'error'); return false; } } // æµ‹è¯•å“åº”å¼è®¾è®¡ async testResponsiveDesign() { this.log('ğŸ§ª æµ‹è¯•å“åº”å¼è®¾è®¡', 'user'); this.currentStep = 6; try { const originalWidth = window.innerWidth; // æ¨¡æ‹Ÿç§»åŠ¨è®¾å¤‡ this.log('ğŸ“± æ¨¡æ‹Ÿç§»åŠ¨è®¾å¤‡è§†å£', 'user'); window.resizeTo(375, 667); await this.sleep(1000); // æ£€æŸ¥å…ƒç´ æ˜¯å¦ä»ç„¶å¯è§å’Œå¯ç”¨ const chatContainer = document.getElementById('chatContainer'); const messageInput = document.getElementById('messageInput'); if (chatContainer && messageInput) { const containerRect = chatContainer.getBoundingClientRect(); const inputRect = messageInput.getBoundingClientRect(); if (containerRect.width > 0 && inputRect.width > 0) { this.log('âœ… ç§»åŠ¨è®¾å¤‡å¸ƒå±€æ­£å¸¸', 'success'); } else { this.log('âš ï¸ ç§»åŠ¨è®¾å¤‡å¸ƒå±€å¯èƒ½æœ‰é—®é¢˜', 'warn'); } } // æ¢å¤åŸå§‹å°ºå¯¸ window.resizeTo(originalWidth, window.innerHeight); await this.sleep(500); return true; } catch (error) { this.log(`âŒ å“åº”å¼è®¾è®¡æµ‹è¯•å¤±è´¥: ${error.message}`, 'error'); return false; } } // ç”ŸæˆUXæµ‹è¯•æŠ¥å‘Š generateUXReport() { const report = { timestamp: new Date().toISOString(), totalTests: this.testResults.length, successCount: this.testResults.filter(r => r.type === 'success').length, errorCount: this.testResults.filter(r => r.type === 'error').length, warnCount: this.testResults.filter(r => r.type === 'warn').length, userScore: 0, results: this.testResults }; // è®¡ç®—ç”¨æˆ·ä½“éªŒè¯„åˆ† const totalNonInfoMessages = report.successCount + report.errorCount + report.warnCount; if (totalNonInfoMessages > 0) { report.userScore = Math.round((report.successCount / totalNonInfoMessages) * 100); } console.log('\n' + '='.repeat(60));  console.log('='.repeat(60)); console.log(`ğŸ•’ æµ‹è¯•æ—¶é—´: ${new Date().toLocaleString()}`);      // è¯„çº§ let grade = 'F'; if (report.userScore >= 90) grade = 'A+'; else if (report.userScore >= 80) grade = 'A'; else if (report.userScore >= 70) grade = 'B'; else if (report.userScore >= 60) grade = 'C'; else if (report.userScore >= 50) grade = 'D';  if (report.errorCount > 0) {  this.testResults .filter(r => r.type === 'error') .forEach((result, index) => {  }); } if (report.warnCount > 0) {  this.testResults .filter(r => r.type === 'warn') .forEach((result, index) => {  }); }  if (report.userScore >= 90) {  } else if (report.userScore >= 70) {  } else {   } console.log('='.repeat(60)); return report; } // è¿è¡Œå®Œæ•´çš„ç”¨æˆ·ä½“éªŒæµ‹è¯• async runFullUXTest() { if (this.isRunning) { this.log('æµ‹è¯•å·²åœ¨è¿è¡Œä¸­...', 'warn'); return; } this.isRunning = true; this.testResults = []; this.currentStep = 0;  try { // æ‰§è¡Œæ‰€æœ‰æµ‹è¯•æµç¨‹ await this.testFirstTimeVisit(); await this.sleep(1000); await this.testUIInteractions(); await this.sleep(1000); await this.testErrorHandling(); await this.sleep(1000); await this.testResponsiveDesign(); // ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š const report = this.generateUXReport(); // æš´éœ²æŠ¥å‘Šåˆ°å…¨å±€ window.uxTestReport = report; this.log('ğŸ ç”¨æˆ·ä½“éªŒæµ‹è¯•å®Œæˆ', 'success'); return report; } catch (error) { this.log(`âŒ ç”¨æˆ·ä½“éªŒæµ‹è¯•å¼‚å¸¸: ${error.message}`, 'error'); return null; } finally { this.isRunning = false; } } } // è‡ªåŠ¨æ‰§è¡Œç”¨æˆ·ä½“éªŒæµ‹è¯• document.addEventListener('DOMContentLoaded', async () => { // ç­‰å¾…æ‰€æœ‰å…¶ä»–è„šæœ¬å’Œä¿®å¤å®Œæˆ await new Promise(resolve => setTimeout(resolve, 5000));  const validator = new UserExperienceValidator(); await validator.runFullUXTest(); // æš´éœ²éªŒè¯å™¨åˆ°å…¨å±€ window.uxValidator = validator; console.log('ğŸ’¡ æç¤º: ä½¿ç”¨ uxValidator.runFullUXTest() é‡æ–°è¿è¡Œç”¨æˆ·ä½“éªŒæµ‹è¯•'); }); // å¦‚æœé¡µé¢å·²åŠ è½½ï¼Œå»¶è¿Ÿè¿è¡Œ if (document.readyState !== 'loading') { setTimeout(async () => {  const validator = new UserExperienceValidator(); await validator.runFullUXTest(); window.uxValidator = validator; console.log('ğŸ’¡ æç¤º: ä½¿ç”¨ uxValidator.runFullUXTest() é‡æ–°è¿è¡Œç”¨æˆ·ä½“éªŒæµ‹è¯•'); }, 5000); } 