 class DataVisualizationEnhancement { constructor() { this.dataConnections = new Map(); this.visualizations = new Map(); this.animationParameters = { particleCount: 20, speed: 1.0, colorScheme: 'quantum', intensity: 1.0 }; this.dataTypes = { system: ['cpu', 'memory', 'gpu', 'network'], performance: ['fps', 'loadTime', 'renderTime'], user: ['interactions', 'timeOnPage', 'scrollDepth'], realtime: ['timestamp', 'randomSeed', 'weatherAPI'] }; this.init(); } init() { this.setupDataSources(); this.createVisualizationMappings(); this.startDataCollection();  } // è®¾ç½®æ•°æ®æº setupDataSources() { // ç³»ç»Ÿæ€§èƒ½æ•°æ® this.dataConnections.set('system', { type: 'system', active: true, updateInterval: 1000, lastUpdate: 0, data: {} }); // ç”¨æˆ·äº¤äº’æ•°æ® this.dataConnections.set('user', { type: 'user', active: true, updateInterval: 100, lastUpdate: 0, data: { interactions: 0, mouseX: 0, mouseY: 0, scrollY: 0 } }); // å®æ—¶éšæœºæ•°æ® this.dataConnections.set('random', { type: 'random', active: true, updateInterval: 50, lastUpdate: 0, data: {} }); // å¤–éƒ¨APIæ•°æ®ï¼ˆç¤ºä¾‹ï¼šå¤©æ°”ã€è‚¡ç¥¨ç­‰ï¼‰ this.dataConnections.set('external', { type: 'external', active: false, updateInterval: 60000, lastUpdate: 0, data: {} }); } // åˆ›å»ºæ•°æ®åˆ°è§†è§‰æ•ˆæœçš„æ˜ å°„ createVisualizationMappings() { // CPUä½¿ç”¨ç‡ â†’ ç²’å­é€Ÿåº¦ this.addMapping('system.cpu', (value) => { this.updateAnimationParameter('speed', 0.5 + (value / 100) * 1.5); }); // å†…å­˜ä½¿ç”¨ç‡ â†’ ç²’å­å¯†åº¦ this.addMapping('system.memory', (value) => { const count = Math.floor(10 + (value / 100) * 40); this.updateAnimationParameter('particleCount', count); }); // é¼ æ ‡ä½ç½® â†’ ç²’å­å¼•åŠ›ä¸­å¿ƒ this.addMapping('user.mouse', (data) => { this.updateGravityCenter(data.x, data.y); }); // æ»šåŠ¨æ·±åº¦ â†’ è‰²å½©å¼ºåº¦ this.addMapping('user.scroll', (value) => { const intensity = Math.min(2.0, 0.5 + value * 0.001); this.updateAnimationParameter('intensity', intensity); }); // éšæœºæ•° â†’ è‰²å½©å˜åŒ– this.addMapping('random.seed', (value) => { this.updateColorScheme(value); }); // æ—¶é—´ â†’ åŠ¨ç”»èŠ‚å¥ this.addMapping('realtime.timestamp', (timestamp) => { const rhythm = Math.sin(timestamp * 0.001) * 0.5 + 0.5; this.updateAnimationRhythm(rhythm); }); } addMapping(dataPath, callback) { this.visualizations.set(dataPath, callback); } // å¼€å§‹æ•°æ®æ”¶é›† startDataCollection() { // ç³»ç»Ÿæ€§èƒ½ç›‘æ§ this.collectSystemData(); setInterval(() => this.collectSystemData(), 1000); // ç”¨æˆ·äº¤äº’ç›‘æ§ this.setupUserInteractionTracking(); // éšæœºæ•°æ®ç”Ÿæˆ this.generateRandomData(); setInterval(() => this.generateRandomData(), 50); // å®æ—¶æ—¶é—´æˆ³ setInterval(() => this.updateTimestamp(), 16); // 60fps } collectSystemData() { const data = this.dataConnections.get('system'); // æ¨¡æ‹Ÿç³»ç»Ÿæ•°æ®ï¼ˆå®é™…åº”ç”¨ä¸­å¯ä»¥é€šè¿‡APIè·å–ï¼‰ data.data = { cpu: this.getRandomValue(20, 80), // CPUä½¿ç”¨ç‡ 20-80% memory: this.getRandomValue(30, 70), // å†…å­˜ä½¿ç”¨ç‡ 30-70% gpu: this.getRandomValue(10, 90), // GPUä½¿ç”¨ç‡ 10-90% network: this.getRandomValue(0, 100) // ç½‘ç»œæ´»åŠ¨ 0-100% }; data.lastUpdate = Date.now(); this.processDataUpdate('system', data.data); } setupUserInteractionTracking() { const data = this.dataConnections.get('user'); // é¼ æ ‡ç§»åŠ¨ document.addEventListener('mousemove', (event) => { data.data.mouseX = event.clientX; data.data.mouseY = event.clientY; data.lastUpdate = Date.now(); this.processDataUpdate('user.mouse', { x: event.clientX, y: event.clientY }); }); // ç‚¹å‡»è®¡æ•° document.addEventListener('click', () => { data.data.interactions++; this.processDataUpdate('user.interactions', data.data.interactions); }); // æ»šåŠ¨æ·±åº¦ window.addEventListener('scroll', () => { data.data.scrollY = window.scrollY; this.processDataUpdate('user.scroll', window.scrollY); }); // é”®ç›˜äº¤äº’ document.addEventListener('keydown', () => { data.data.interactions++; }); } generateRandomData() { const data = this.dataConnections.get('random'); data.data = { seed: Math.random(), noise: this.perlinNoise(Date.now() * 0.001), wave: Math.sin(Date.now() * 0.003), fluctuation: Math.random() * 2 - 1 }; data.lastUpdate = Date.now(); this.processDataUpdate('random.seed', data.data.seed); } updateTimestamp() { const timestamp = Date.now(); this.processDataUpdate('realtime.timestamp', timestamp); } processDataUpdate(dataPath, value) { const callback = this.visualizations.get(dataPath); if (callback) { try { callback(value); } catch (error) { console.warn(`æ•°æ®æ˜ å°„æ‰§è¡Œå¤±è´¥ ${dataPath}:`, error); } } } // æ›´æ–°åŠ¨ç”»å‚æ•° updateAnimationParameter(param, value) { this.animationParameters[param] = value; // é€šçŸ¥åŠ¨ç”»ç³»ç»Ÿæ›´æ–° if (window.cppAnimation && window.cppAnimation.updateParameter) { window.cppAnimation.updateParameter(param, value); } // é€šçŸ¥æ€§èƒ½ç›‘æ§ç³»ç»Ÿ if (window.performanceMonitor && param === 'particleCount') { window.performanceMonitor.updateSettings({ particleCount: value }); } } updateGravityCenter(x, y) { if (window.cppAnimation && window.cppAnimation.setGravityCenter) { const container = document.querySelector('.cpp-animation-container-enhanced'); if (container) { const rect = container.getBoundingClientRect(); const relativeX = (x - rect.left) / rect.width; const relativeY = (y - rect.top) / rect.height; window.cppAnimation.setGravityCenter(relativeX, relativeY); } } } updateColorScheme(seed) { const schemes = [ 'quantum', 'cyberpunk', 'aurora', 'plasma', 'matrix', 'galaxy' ]; const index = Math.floor(seed * schemes.length); const scheme = schemes[index]; this.animationParameters.colorScheme = scheme; if (window.cppAnimation && window.cppAnimation.setColorScheme) { window.cppAnimation.setColorScheme(scheme); } } updateAnimationRhythm(rhythm) { if (window.cppAnimation && window.cppAnimation.setRhythm) { window.cppAnimation.setRhythm(rhythm); } } // å¤–éƒ¨APIæ•°æ®è·å– async fetchExternalData() { try { // ç¤ºä¾‹ï¼šè·å–å¤©æ°”æ•°æ® const weatherResponse = await fetch('https://api.openweathermap.org/data/2.5/weather?q=Beijing&appid=YOUR_API_KEY'); const weatherData = await weatherResponse.json(); this.processDataUpdate('external.weather', weatherData); // ç¤ºä¾‹ï¼šæ ¹æ®å¤©æ°”è°ƒæ•´åŠ¨ç”» this.mapWeatherToAnimation(weatherData); } catch (error) { console.warn('å¤–éƒ¨æ•°æ®è·å–å¤±è´¥:', error); } } mapWeatherToAnimation(weatherData) { if (!weatherData.weather) return; const condition = weatherData.weather[0].main.toLowerCase(); const mappings = { 'clear': { colorScheme: 'aurora', speed: 1.2 }, 'clouds': { colorScheme: 'matrix', speed: 0.8 }, 'rain': { colorScheme: 'cyberpunk', intensity: 1.5 }, 'snow': { colorScheme: 'quantum', particleCount: 50 }, 'thunderstorm': { colorScheme: 'plasma', speed: 2.0 } }; const mapping = mappings[condition]; if (mapping) { Object.entries(mapping).forEach(([param, value]) => { this.updateAnimationParameter(param, value); }); } } // å·¥å…·å‡½æ•° getRandomValue(min, max) { return Math.random() * (max - min) + min; } perlinNoise(x) { // ç®€åŒ–çš„æŸæ—å™ªå£°å®ç° const noise = Math.sin(x) * Math.sin(x * 2.1) * Math.sin(x * 3.7); return (noise + 1) / 2; } // æ•°æ®åˆ†æå’Œç»Ÿè®¡ getDataStats(dataPath) { const connection = this.dataConnections.get(dataPath.split('.')[0]); if (!connection) return null; return { lastUpdate: connection.lastUpdate, updateInterval: connection.updateInterval, active: connection.active, data: connection.data }; } getAllStats() { const stats = {}; this.dataConnections.forEach((connection, key) => { stats[key] = this.getDataStats(key); }); return stats; } // æ§åˆ¶æ–¹æ³• enableDataSource(sourceName) { const connection = this.dataConnections.get(sourceName); if (connection) { connection.active = true; } } disableDataSource(sourceName) { const connection = this.dataConnections.get(sourceName); if (connection) { connection.active = false; } } setUpdateInterval(sourceName, interval) { const connection = this.dataConnections.get(sourceName); if (connection) { connection.updateInterval = interval; } } // å®æ—¶æ•°æ®å¯¼å‡º exportData(format = 'json') { const data = { timestamp: Date.now(), parameters: this.animationParameters, connections: {} }; this.dataConnections.forEach((connection, key) => { data.connections[key] = { type: connection.type, active: connection.active, lastUpdate: connection.lastUpdate, data: connection.data }; }); if (format === 'json') { return JSON.stringify(data, null, 2); } return data; } // åˆ›å»ºå®æ—¶æ•°æ®é¢æ¿ createDataDashboard() { const dashboard = document.createElement('div'); dashboard.id = 'data-dashboard'; dashboard.style.cssText = ` position: fixed; top: 10px; right: 10px; width: 300px; background: rgba(0, 0, 0, 0.8); color: #00ff00; padding: 10px; border-radius: 8px; font-family: 'JetBrains Mono', monospace; font-size: 10px; z-index: 10000; max-height: 400px; overflow-y: auto; backdrop-filter: blur(10px); `; document.body.appendChild(dashboard); // å®šæœŸæ›´æ–°é¢æ¿ setInterval(() => { this.updateDashboard(dashboard); }, 100); return dashboard; } updateDashboard(dashboard) { const stats = this.getAllStats(); let html = '<h3>ğŸ”¬ å®æ—¶æ•°æ®ç›‘æ§</h3>'; html += `<div>åŠ¨ç”»å‚æ•°: ${JSON.stringify(this.animationParameters, null, 1)}</div><br>`; Object.entries(stats).forEach(([key, data]) => { if (data && data.active) { html += `<div><strong>${key}:</strong><br>`; html += ` æœ€åæ›´æ–°: ${new Date(data.lastUpdate).toLocaleTimeString()}<br>`; html += ` æ•°æ®: ${JSON.stringify(data.data, null, 1)}<br>`; html += '</div><br>'; } }); dashboard.innerHTML = html; } } // å…¨å±€å®ä¾‹ window.dataVisualization = new DataVisualizationEnhancement(); 