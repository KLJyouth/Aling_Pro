<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¤ºä¾‹ä»£ç  - ç‘å‡Œç§‘æŠ€</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-dark.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body class="bg-quantum-dark text-white overflow-x-hidden">
    <!-- å¯¼èˆªæ  -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-black/20 backdrop-blur-xl border-b border-quantum-primary/20">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-quantum-primary to-quantum-secondary rounded-lg flex items-center justify-center">
                        <i class="fas fa-atom text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold bg-gradient-to-r from-quantum-primary to-quantum-accent bg-clip-text text-transparent">
                            ç‘å‡Œç§‘æŠ€
                        </h1>
                        <p class="text-xs text-gray-400">ç¤ºä¾‹ä»£ç </p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="/" class="px-4 py-2 text-quantum-accent hover:text-white transition-colors duration-300">è¿”å›é¦–é¡µ</a>
                    <a href="/sdk-download.html" class="px-4 py-2 bg-gradient-to-r from-quantum-primary to-quantum-secondary rounded-lg text-white text-sm hover:shadow-lg transition-all duration-300">
                        ä¸‹è½½SDK
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="pt-20">
        <!-- è‹±é›„åŒºåŸŸ -->
        <section class="py-20 bg-gradient-to-b from-quantum-purple/20 to-transparent">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h1 class="text-5xl font-bold mb-6 bg-gradient-to-r from-quantum-primary to-quantum-accent bg-clip-text text-transparent">
                        ç¤ºä¾‹ä»£ç åº“
                    </h1>
                    <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                        ä¸°å¯Œçš„ä»£ç ç¤ºä¾‹ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹AlingAIé‡å­å®‰å…¨æœåŠ¡
                    </p>
                </div>
            </div>
        </section>

        <!-- åˆ†ç±»å¯¼èˆª -->
        <section class="py-10">
            <div class="container mx-auto px-6">
                <div class="flex flex-wrap justify-center gap-4 mb-16">
                    <button class="code-category-btn active px-6 py-3 bg-quantum-primary rounded-lg text-white font-semibold hover:shadow-lg transition-all duration-300" data-category="all">
                        å…¨éƒ¨ç¤ºä¾‹
                    </button>
                    <button class="code-category-btn px-6 py-3 bg-white/10 rounded-lg text-gray-300 font-semibold hover:bg-quantum-accent hover:text-white transition-all duration-300" data-category="encryption">
                        åŠ å¯†è§£å¯†
                    </button>
                    <button class="code-category-btn px-6 py-3 bg-white/10 rounded-lg text-gray-300 font-semibold hover:bg-quantum-accent hover:text-white transition-all duration-300" data-category="key-management">
                        å¯†é’¥ç®¡ç†
                    </button>
                    <button class="code-category-btn px-6 py-3 bg-white/10 rounded-lg text-gray-300 font-semibold hover:bg-quantum-accent hover:text-white transition-all duration-300" data-category="authentication">
                        èº«ä»½è®¤è¯
                    </button>
                    <button class="code-category-btn px-6 py-3 bg-white/10 rounded-lg text-gray-300 font-semibold hover:bg-quantum-accent hover:text-white transition-all duration-300" data-category="integration">
                        æ¡†æ¶é›†æˆ
                    </button>
                </div>
            </div>
        </section>

        <!-- ä»£ç ç¤ºä¾‹ -->
        <section class="py-20">
            <div class="container mx-auto px-6">
                <div class="grid gap-8">
                    <!-- Python åŠ å¯†ç¤ºä¾‹ -->
                    <div class="code-example p-8 bg-white/5 backdrop-blur-sm rounded-2xl border border-quantum-primary/20" data-category="encryption">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <i class="fab fa-python text-quantum-primary text-2xl mr-4"></i>
                                <div>
                                    <h3 class="text-xl font-bold">Python - é‡å­åŠ å¯†è§£å¯†</h3>
                                    <p class="text-gray-400">ä½¿ç”¨åé‡å­åŠ å¯†ç®—æ³•ä¿æŠ¤æ•°æ®</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="copy-btn px-3 py-1 bg-quantum-accent rounded text-white text-sm hover:bg-quantum-accent/80 transition-colors duration-300">
                                    <i class="fas fa-copy mr-1"></i>å¤åˆ¶
                                </button>
                                <button class="px-3 py-1 bg-quantum-secondary rounded text-white text-sm hover:bg-quantum-secondary/80 transition-colors duration-300">
                                    <i class="fas fa-download mr-1"></i>ä¸‹è½½
                                </button>
                            </div>
                        </div>
                        <div class="bg-black/50 rounded-lg overflow-hidden">
                            <pre class="p-4 text-sm overflow-x-auto"><code class="language-python">#!/usr/bin/env python3
"""
AlingAI é‡å­åŠ å¯†ç¤ºä¾‹
æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨åé‡å­åŠ å¯†ç®—æ³•ä¿æŠ¤æ•æ„Ÿæ•°æ®
"""

from alingai import QuantumSecurity, QuantumKeyManager
import asyncio
import json

class QuantumEncryptionDemo:
    def __init__(self, api_key: str):
        """åˆå§‹åŒ–é‡å­å®‰å…¨å®¢æˆ·ç«¯"""
        self.client = QuantumSecurity(api_key=api_key)
        self.key_manager = QuantumKeyManager(api_key=api_key)
    
    async def generate_quantum_key(self, key_size: int = 256) -> str:
        """ç”Ÿæˆé‡å­å®‰å…¨å¯†é’¥"""
        try:
            key_result = await self.key_manager.generate_key(
                algorithm="KYBER-768",  # åé‡å­å¯†é’¥äº¤æ¢ç®—æ³•
                key_size=key_size,
                purpose="encryption"
            )
            print(f"âœ… é‡å­å¯†é’¥ç”ŸæˆæˆåŠŸ: {key_result['key_id']}")
            return key_result['key_id']
        except Exception as e:
            print(f"âŒ å¯†é’¥ç”Ÿæˆå¤±è´¥: {e}")
            raise
    
    async def encrypt_data(self, data: str, key_id: str) -> dict:
        """ä½¿ç”¨é‡å­å¯†é’¥åŠ å¯†æ•°æ®"""
        try:
            # ä½¿ç”¨CRYSTALS-Kyberç®—æ³•è¿›è¡ŒåŠ å¯†
            encrypted_result = await self.client.encrypt(
                data=data.encode('utf-8'),
                key_id=key_id,
                algorithm="AES-256-GCM-QUANTUM"  # é‡å­å¢å¼ºçš„AESç®—æ³•
            )
            
            print(f"âœ… æ•°æ®åŠ å¯†æˆåŠŸ")
            print(f"   - åŸå§‹å¤§å°: {len(data)} å­—ç¬¦")
            print(f"   - åŠ å¯†å¤§å°: {len(encrypted_result['ciphertext'])} å­—èŠ‚")
            
            return encrypted_result
        except Exception as e:
            print(f"âŒ æ•°æ®åŠ å¯†å¤±è´¥: {e}")
            raise
    
    async def decrypt_data(self, encrypted_data: dict, key_id: str) -> str:
        """è§£å¯†æ•°æ®"""
        try:
            decrypted_bytes = await self.client.decrypt(
                ciphertext=encrypted_data['ciphertext'],
                key_id=key_id,
                nonce=encrypted_data['nonce'],
                tag=encrypted_data['tag']
            )
            
            decrypted_text = decrypted_bytes.decode('utf-8')
            print(f"âœ… æ•°æ®è§£å¯†æˆåŠŸ")
            return decrypted_text
        except Exception as e:
            print(f"âŒ æ•°æ®è§£å¯†å¤±è´¥: {e}")
            raise
    
    async def demonstrate_file_encryption(self, file_path: str):
        """æ¼”ç¤ºæ–‡ä»¶åŠ å¯†"""
        # è¯»å–æ–‡ä»¶
        with open(file_path, 'rb') as f:
            file_data = f.read()
        
        # ç”Ÿæˆä¸“ç”¨å¯†é’¥
        key_id = await self.generate_quantum_key()
        
        # åŠ å¯†æ–‡ä»¶
        encrypted_file = await self.client.encrypt_file(
            file_data=file_data,
            key_id=key_id,
            metadata={
                "original_filename": file_path,
                "file_type": file_path.split('.')[-1],
                "encryption_timestamp": "2024-06-15T10:30:00Z"
            }
        )
        
        # ä¿å­˜åŠ å¯†æ–‡ä»¶
        encrypted_path = f"{file_path}.encrypted"
        with open(encrypted_path, 'wb') as f:
            f.write(encrypted_file['ciphertext'])
        
        print(f"âœ… æ–‡ä»¶åŠ å¯†å®Œæˆ: {encrypted_path}")
        return encrypted_path, key_id

async def main():
    """ä¸»æ¼”ç¤ºå‡½æ•°"""
    # åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆè¯·æ›¿æ¢ä¸ºæ‚¨çš„APIå¯†é’¥ï¼‰
    demo = QuantumEncryptionDemo(api_key="your_api_key_here")
    
    # ç¤ºä¾‹1: æ–‡æœ¬åŠ å¯†
    print("ğŸ” ç¤ºä¾‹1: æ–‡æœ¬æ•°æ®åŠ å¯†æ¼”ç¤º")
    print("-" * 50)
    
    sensitive_data = "è¿™æ˜¯éœ€è¦ä¿æŠ¤çš„æ•æ„Ÿä¿¡æ¯ï¼šé“¶è¡Œè´¦å· 1234567890"
    
    # ç”Ÿæˆé‡å­å¯†é’¥
    key_id = await demo.generate_quantum_key()
    
    # åŠ å¯†æ•°æ®
    encrypted = await demo.encrypt_data(sensitive_data, key_id)
    
    # è§£å¯†æ•°æ®
    decrypted = await demo.decrypt_data(encrypted, key_id)
    
    # éªŒè¯ç»“æœ
    assert sensitive_data == decrypted, "è§£å¯†ç»“æœä¸åŒ¹é…!"
    print(f"âœ… åŠ å¯†è§£å¯†éªŒè¯æˆåŠŸ!")
    print(f"   - åŸå§‹æ•°æ®: {sensitive_data}")
    print(f"   - è§£å¯†æ•°æ®: {decrypted}")
    
    # ç¤ºä¾‹2: æ‰¹é‡åŠ å¯†
    print("\nğŸ” ç¤ºä¾‹2: æ‰¹é‡æ•°æ®åŠ å¯†æ¼”ç¤º")
    print("-" * 50)
    
    batch_data = [
        "ç”¨æˆ·ID: user_123",
        "æ‰‹æœºå·: +86 138****1234", 
        "é‚®ç®±: user@example.com",
        "åœ°å€: åŒ—äº¬å¸‚æœé˜³åŒºxxxè·¯xxxå·"
    ]
    
    encrypted_batch = []
    for i, data in enumerate(batch_data):
        encrypted = await demo.encrypt_data(data, key_id)
        encrypted_batch.append(encrypted)
        print(f"   ç¬¬{i+1}æ¡æ•°æ®åŠ å¯†å®Œæˆ")
    
    print(f"âœ… æ‰¹é‡åŠ å¯†å®Œæˆï¼Œå…±å¤„ç† {len(batch_data)} æ¡æ•°æ®")

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
                        </div>
                    </div>

                    <!-- JavaScript å¯†é’¥ç®¡ç†ç¤ºä¾‹ -->
                    <div class="code-example p-8 bg-white/5 backdrop-blur-sm rounded-2xl border border-quantum-accent/20" data-category="key-management">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <i class="fab fa-js-square text-quantum-accent text-2xl mr-4"></i>
                                <div>
                                    <h3 class="text-xl font-bold">JavaScript - é‡å­å¯†é’¥ç®¡ç†</h3>
                                    <p class="text-gray-400">å‰ç«¯å¯†é’¥ç®¡ç†å’Œå®‰å…¨å­˜å‚¨</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="copy-btn px-3 py-1 bg-quantum-accent rounded text-white text-sm hover:bg-quantum-accent/80 transition-colors duration-300">
                                    <i class="fas fa-copy mr-1"></i>å¤åˆ¶
                                </button>
                                <button class="px-3 py-1 bg-quantum-secondary rounded text-white text-sm hover:bg-quantum-secondary/80 transition-colors duration-300">
                                    <i class="fas fa-download mr-1"></i>ä¸‹è½½
                                </button>
                            </div>
                        </div>
                        <div class="bg-black/50 rounded-lg overflow-hidden">
                            <pre class="p-4 text-sm overflow-x-auto"><code class="language-javascript">/**
 * AlingAI é‡å­å¯†é’¥ç®¡ç†ç¤ºä¾‹
 * æ¼”ç¤ºå‰ç«¯å®‰å…¨çš„å¯†é’¥ç”Ÿæˆã€å­˜å‚¨å’Œç®¡ç†
 */

import { QuantumKeyManager, SecureStorage } from '@alingai/sdk';

class FrontendKeyManager {
    constructor(apiKey) {
        this.keyManager = new QuantumKeyManager({
            apiKey: apiKey,
            environment: 'production',
            enableLogging: true
        });
        
        this.secureStorage = new SecureStorage({
            storageType: 'indexedDB',
            encryption: true
        });
        
        this.keyCache = new Map();
    }

    /**
     * ç”Ÿæˆæ–°çš„é‡å­å¯†é’¥å¯¹
     * @param {string} purpose - å¯†é’¥ç”¨é€” ('encryption', 'signing', 'key-exchange')
     * @param {number} keySize - å¯†é’¥å¤§å°
     * @returns {Promise&lt;Object&gt;} å¯†é’¥ä¿¡æ¯
     */
    async generateKeyPair(purpose = 'encryption', keySize = 256) {
        try {
            console.log(`ğŸ”‘ æ­£åœ¨ç”Ÿæˆ${purpose}å¯†é’¥å¯¹...`);
            
            const keyPair = await this.keyManager.generateKeyPair({
                algorithm: this.getAlgorithmForPurpose(purpose),
                keySize: keySize,
                purpose: purpose,
                metadata: {
                    created: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    origin: window.location.origin
                }
            });
            
            // å®‰å…¨å­˜å‚¨å¯†é’¥
            await this.storeKeySecurely(keyPair);
            
            console.log(`âœ… å¯†é’¥å¯¹ç”ŸæˆæˆåŠŸ: ${keyPair.keyId}`);
            return keyPair;
            
        } catch (error) {
            console.error(`âŒ å¯†é’¥ç”Ÿæˆå¤±è´¥:`, error);
            throw error;
        }
    }

    /**
     * æ ¹æ®ç”¨é€”è·å–æ¨èç®—æ³•
     */
    getAlgorithmForPurpose(purpose) {
        const algorithms = {
            'encryption': 'KYBER-768',      // åé‡å­å¯†é’¥å°è£…
            'signing': 'DILITHIUM-3',       // åé‡å­æ•°å­—ç­¾å
            'key-exchange': 'KYBER-1024'    // é«˜å¼ºåº¦å¯†é’¥äº¤æ¢
        };
        return algorithms[purpose] || 'KYBER-768';
    }

    /**
     * å®‰å…¨å­˜å‚¨å¯†é’¥
     */
    async storeKeySecurely(keyPair) {
        try {
            // ä½¿ç”¨ IndexedDB å®‰å…¨å­˜å‚¨
            await this.secureStorage.setItem(`key_${keyPair.keyId}`, {
                keyId: keyPair.keyId,
                publicKey: keyPair.publicKey,
                // ç§é’¥ç»è¿‡é¢å¤–åŠ å¯†åå­˜å‚¨
                privateKey: await this.encryptPrivateKey(keyPair.privateKey),
                algorithm: keyPair.algorithm,
                created: keyPair.metadata.created,
                purpose: keyPair.purpose
            });
            
            // ç¼“å­˜å…¬é’¥ç”¨äºå¿«é€Ÿè®¿é—®
            this.keyCache.set(keyPair.keyId, {
                publicKey: keyPair.publicKey,
                algorithm: keyPair.algorithm
            });
            
            console.log(`ğŸ”’ å¯†é’¥å®‰å…¨å­˜å‚¨å®Œæˆ: ${keyPair.keyId}`);
            
        } catch (error) {
            console.error('å¯†é’¥å­˜å‚¨å¤±è´¥:', error);
            throw error;
        }
    }

    /**
     * åŠ å¯†ç§é’¥ï¼ˆä½¿ç”¨ç”¨æˆ·å¯†ç æˆ–ç”Ÿç‰©è¯†åˆ«ï¼‰
     */
    async encryptPrivateKey(privateKey) {
        // æ¨¡æ‹Ÿä½¿ç”¨ç”¨æˆ·ä¸»å¯†ç åŠ å¯†ç§é’¥
        const userSecret = await this.getUserSecret();
        return await this.keyManager.encryptWithPassword(privateKey, userSecret);
    }

    /**
     * è·å–ç”¨æˆ·å¯†é’¥ï¼ˆå®é™…åº”ç”¨ä¸­å¯èƒ½ä½¿ç”¨ç”Ÿç‰©è¯†åˆ«æˆ–å¯†ç ï¼‰
     */
    async getUserSecret() {
        // è¿™é‡Œå¯ä»¥é›†æˆ WebAuthnã€ç”Ÿç‰©è¯†åˆ«ç­‰
        return 'user_master_password_hash';
    }

    /**
     * å¯†é’¥è½®æ¢ - å®šæœŸæ›´æ–°å¯†é’¥
     */
    async rotateKeys() {
        try {
            console.log('ğŸ”„ å¼€å§‹å¯†é’¥è½®æ¢...');
            
            const oldKeys = await this.getAllStoredKeys();
            const rotationResults = [];
            
            for (const oldKey of oldKeys) {
                // æ£€æŸ¥å¯†é’¥å¹´é¾„
                const keyAge = Date.now() - new Date(oldKey.created).getTime();
                const maxAge = 30 * 24 * 60 * 60 * 1000; // 30å¤©
                
                if (keyAge > maxAge) {
                    console.log(`ğŸ”„ è½®æ¢è¿‡æœŸå¯†é’¥: ${oldKey.keyId}`);
                    
                    // ç”Ÿæˆæ–°å¯†é’¥
                    const newKey = await this.generateKeyPair(
                        oldKey.purpose,
                        oldKey.keySize
                    );
                    
                    // æ ‡è®°æ—§å¯†é’¥ä¸ºå·²è½®æ¢
                    await this.markKeyAsRotated(oldKey.keyId, newKey.keyId);
                    
                    rotationResults.push({
                        oldKeyId: oldKey.keyId,
                        newKeyId: newKey.keyId,
                        rotatedAt: new Date().toISOString()
                    });
                }
            }
            
            console.log(`âœ… å¯†é’¥è½®æ¢å®Œæˆï¼Œå…±è½®æ¢ ${rotationResults.length} ä¸ªå¯†é’¥`);
            return rotationResults;
            
        } catch (error) {
            console.error('âŒ å¯†é’¥è½®æ¢å¤±è´¥:', error);
            throw error;
        }
    }

    /**
     * è·å–æ‰€æœ‰å­˜å‚¨çš„å¯†é’¥
     */
    async getAllStoredKeys() {
        const keys = await this.secureStorage.getAllItems();
        return Object.values(keys).filter(item => item.keyId);
    }

    /**
     * æ ‡è®°å¯†é’¥ä¸ºå·²è½®æ¢
     */
    async markKeyAsRotated(oldKeyId, newKeyId) {
        const oldKey = await this.secureStorage.getItem(`key_${oldKeyId}`);
        if (oldKey) {
            oldKey.status = 'rotated';
            oldKey.rotatedTo = newKeyId;
            oldKey.rotatedAt = new Date().toISOString();
            await this.secureStorage.setItem(`key_${oldKeyId}`, oldKey);
        }
    }

    /**
     * åŠ å¯†æ–‡ä»¶ï¼ˆå‰ç«¯å¤„ç†ï¼‰
     */
    async encryptFile(file, keyId) {
        try {
            console.log(`ğŸ” å¼€å§‹åŠ å¯†æ–‡ä»¶: ${file.name}`);
            
            const arrayBuffer = await file.arrayBuffer();
            const fileData = new Uint8Array(arrayBuffer);
            
            const encryptedResult = await this.keyManager.encryptData({
                data: fileData,
                keyId: keyId,
                metadata: {
                    originalName: file.name,
                    originalSize: file.size,
                    mimeType: file.type,
                    encryptedAt: new Date().toISOString()
                }
            });
            
            // åˆ›å»ºåŠ å¯†æ–‡ä»¶çš„ Blob
            const encryptedBlob = new Blob([encryptedResult.ciphertext], {
                type: 'application/octet-stream'
            });
            
            console.log(`âœ… æ–‡ä»¶åŠ å¯†å®Œæˆ: ${file.name}`);
            console.log(`   - åŸå§‹å¤§å°: ${file.size} å­—èŠ‚`);
            console.log(`   - åŠ å¯†å¤§å°: ${encryptedBlob.size} å­—èŠ‚`);
            
            return {
                encryptedFile: encryptedBlob,
                metadata: encryptedResult.metadata,
                keyId: keyId
            };
            
        } catch (error) {
            console.error(`âŒ æ–‡ä»¶åŠ å¯†å¤±è´¥:`, error);
            throw error;
        }
    }

    /**
     * æ¸…ç†è¿‡æœŸå¯†é’¥
     */
    async cleanupExpiredKeys() {
        try {
            const allKeys = await this.getAllStoredKeys();
            const expiredKeys = allKeys.filter(key => {
                const keyAge = Date.now() - new Date(key.created).getTime();
                const maxRetentionTime = 90 * 24 * 60 * 60 * 1000; // 90å¤©
                return key.status === 'rotated' && keyAge > maxRetentionTime;
            });
            
            for (const expiredKey of expiredKeys) {
                await this.secureStorage.removeItem(`key_${expiredKey.keyId}`);
                this.keyCache.delete(expiredKey.keyId);
                console.log(`ğŸ—‘ï¸ æ¸…ç†è¿‡æœŸå¯†é’¥: ${expiredKey.keyId}`);
            }
            
            console.log(`âœ… æ¸…ç†å®Œæˆï¼Œåˆ é™¤ ${expiredKeys.length} ä¸ªè¿‡æœŸå¯†é’¥`);
            
        } catch (error) {
            console.error('âŒ å¯†é’¥æ¸…ç†å¤±è´¥:', error);
            throw error;
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
async function demoKeyManagement() {
    const keyManager = new FrontendKeyManager('your_api_key_here');
    
    try {
        // ç”ŸæˆåŠ å¯†å¯†é’¥å¯¹
        const encryptionKey = await keyManager.generateKeyPair('encryption', 256);
        
        // ç”Ÿæˆç­¾åå¯†é’¥å¯¹
        const signingKey = await keyManager.generateKeyPair('signing', 384);
        
        // æ¨¡æ‹Ÿæ–‡ä»¶åŠ å¯†
        const fileInput = document.getElementById('fileInput');
        if (fileInput && fileInput.files[0]) {
            const encrypted = await keyManager.encryptFile(
                fileInput.files[0], 
                encryptionKey.keyId
            );
            
            // ä¸‹è½½åŠ å¯†æ–‡ä»¶
            const downloadLink = document.createElement('a');
            downloadLink.href = URL.createObjectURL(encrypted.encryptedFile);
            downloadLink.download = `${fileInput.files[0].name}.encrypted`;
            downloadLink.click();
        }
        
        // å®šæœŸå¯†é’¥è½®æ¢ï¼ˆç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥å®šæ—¶æ‰§è¡Œï¼‰
        setTimeout(() => {
            keyManager.rotateKeys();
        }, 24 * 60 * 60 * 1000); // 24å°æ—¶åæ‰§è¡Œ
        
    } catch (error) {
        console.error('æ¼”ç¤ºå¤±è´¥:', error);
    }
}

// å¯¼å‡ºä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨
export { FrontendKeyManager, demoKeyManagement };</code></pre>
                        </div>
                    </div>

                    <!-- Java Spring Boot é›†æˆç¤ºä¾‹ -->
                    <div class="code-example p-8 bg-white/5 backdrop-blur-sm rounded-2xl border border-quantum-secondary/20" data-category="integration">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <i class="fab fa-java text-quantum-secondary text-2xl mr-4"></i>
                                <div>
                                    <h3 class="text-xl font-bold">Java - Spring Boot é›†æˆ</h3>
                                    <p class="text-gray-400">ä¼ä¸šçº§åº”ç”¨é›†æˆé‡å­å®‰å…¨æœåŠ¡</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="copy-btn px-3 py-1 bg-quantum-accent rounded text-white text-sm hover:bg-quantum-accent/80 transition-colors duration-300">
                                    <i class="fas fa-copy mr-1"></i>å¤åˆ¶
                                </button>
                                <button class="px-3 py-1 bg-quantum-secondary rounded text-white text-sm hover:bg-quantum-secondary/80 transition-colors duration-300">
                                    <i class="fas fa-download mr-1"></i>ä¸‹è½½
                                </button>
                            </div>
                        </div>
                        <div class="bg-black/50 rounded-lg overflow-hidden">
                            <pre class="p-4 text-sm overflow-x-auto"><code class="language-java">/**
 * Spring Boot é›†æˆ AlingAI é‡å­å®‰å…¨æœåŠ¡
 * æ¼”ç¤ºä¼ä¸šçº§åº”ç”¨ä¸­çš„é‡å­å®‰å…¨é›†æˆ
 */

package com.example.quantumsecurity.config;

import com.alingai.sdk.QuantumSecurityClient;
import com.alingai.sdk.QuantumKeyManager;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;

@Configuration
public class QuantumSecurityConfig {
    
    @Value("${alingai.api.key}")
    private String apiKey;
    
    @Value("${alingai.api.endpoint:https://api.alingai.com}")
    private String apiEndpoint;
    
    @Bean
    @Primary
    public QuantumSecurityClient quantumSecurityClient() {
        return QuantumSecurityClient.builder()
                .apiKey(apiKey)
                .endpoint(apiEndpoint)
                .connectionTimeout(30000)
                .readTimeout(60000)
                .enableRetry(true)
                .maxRetries(3)
                .build();
    }
    
    @Bean
    public QuantumKeyManager quantumKeyManager(QuantumSecurityClient client) {
        return client.getKeyManager();
    }
}

// é‡å­å®‰å…¨æœåŠ¡ç±»
package com.example.quantumsecurity.service;

import com.alingai.sdk.QuantumSecurityClient;
import com.alingai.sdk.QuantumKeyManager;
import com.alingai.sdk.model.*;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import lombok.extern.slf4j.Slf4j;

import java.util.concurrent.CompletableFuture;
import java.util.List;

@Service
@Slf4j
public class QuantumSecurityService {
    
    @Autowired
    private QuantumSecurityClient quantumClient;
    
    @Autowired
    private QuantumKeyManager keyManager;
    
    /**
     * ç”Ÿæˆé‡å­å®‰å…¨å¯†é’¥
     */
    @Transactional
    public CompletableFuture&lt;QuantumKey&gt; generateQuantumKey(KeyGenerationRequest request) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                log.info("ç”Ÿæˆé‡å­å¯†é’¥ï¼Œç®—æ³•: {}, å¤§å°: {}", 
                    request.getAlgorithm(), request.getKeySize());
                
                QuantumKey key = keyManager.generateKey(
                    QuantumKeySpec.builder()
                        .algorithm(request.getAlgorithm())
                        .keySize(request.getKeySize())
                        .purpose(KeyPurpose.ENCRYPTION)
                        .metadata(request.getMetadata())
                        .build()
                );
                
                log.info("é‡å­å¯†é’¥ç”ŸæˆæˆåŠŸ: {}", key.getKeyId());
                return key;
                
            } catch (Exception e) {
                log.error("é‡å­å¯†é’¥ç”Ÿæˆå¤±è´¥", e);
                throw new QuantumSecurityException("å¯†é’¥ç”Ÿæˆå¤±è´¥", e);
            }
        });
    }
    
    /**
     * æ‰¹é‡åŠ å¯†ç”¨æˆ·æ•æ„Ÿæ•°æ®
     */
    @Transactional
    public CompletableFuture&lt;List&lt;EncryptedData&gt;&gt; encryptUserData(
            List&lt;String&gt; sensitiveData, String keyId) {
        
        return CompletableFuture.supplyAsync(() -> {
            try {
                log.info("å¼€å§‹æ‰¹é‡åŠ å¯†ï¼Œæ•°æ®æ¡æ•°: {}, å¯†é’¥ID: {}", 
                    sensitiveData.size(), keyId);
                
                List&lt;EncryptedData&gt; encryptedList = sensitiveData.parallelStream()
                    .map(data -> {
                        try {
                            return quantumClient.encrypt(
                                EncryptionRequest.builder()
                                    .data(data.getBytes("UTF-8"))
                                    .keyId(keyId)
                                    .algorithm("AES-256-GCM-QUANTUM")
                                    .build()
                            );
                        } catch (Exception e) {
                            log.error("æ•°æ®åŠ å¯†å¤±è´¥: {}", data, e);
                            throw new RuntimeException(e);
                        }
                    })
                    .collect(Collectors.toList());
                
                log.info("æ‰¹é‡åŠ å¯†å®Œæˆï¼ŒæˆåŠŸåŠ å¯† {} æ¡æ•°æ®", encryptedList.size());
                return encryptedList;
                
            } catch (Exception e) {
                log.error("æ‰¹é‡åŠ å¯†å¤±è´¥", e);
                throw new QuantumSecurityException("æ‰¹é‡åŠ å¯†å¤±è´¥", e);
            }
        });
    }
    
    /**
     * å®‰å…¨å­˜å‚¨åŠ å¯†å¯†é’¥ï¼ˆå¸¦ç¼“å­˜ï¼‰
     */
    @Cacheable(value = "quantumKeys", key = "#keyId")
    public QuantumKey getKey(String keyId) {
        try {
            log.debug("è·å–é‡å­å¯†é’¥: {}", keyId);
            return keyManager.getKey(keyId);
        } catch (Exception e) {
            log.error("è·å–å¯†é’¥å¤±è´¥: {}", keyId, e);
            throw new QuantumSecurityException("å¯†é’¥è·å–å¤±è´¥", e);
        }
    }
    
    /**
     * å¯†é’¥è½®æ¢æœåŠ¡
     */
    @Scheduled(fixedRate = 86400000) // 24å°æ—¶æ‰§è¡Œä¸€æ¬¡
    @Transactional
    public void rotateKeys() {
        try {
            log.info("å¼€å§‹å®šæœŸå¯†é’¥è½®æ¢");
            
            List&lt;QuantumKey&gt; expiredKeys = keyManager.findExpiredKeys();
            
            for (QuantumKey expiredKey : expiredKeys) {
                // ç”Ÿæˆæ–°å¯†é’¥
                QuantumKey newKey = keyManager.generateKey(
                    QuantumKeySpec.builder()
                        .algorithm(expiredKey.getAlgorithm())
                        .keySize(expiredKey.getKeySize())
                        .purpose(expiredKey.getPurpose())
                        .build()
                );
                
                // æ›´æ–°å¯†é’¥å¼•ç”¨
                updateKeyReferences(expiredKey.getKeyId(), newKey.getKeyId());
                
                // æ ‡è®°æ—§å¯†é’¥ä¸ºå·²è½®æ¢
                keyManager.markKeyAsRotated(expiredKey.getKeyId(), newKey.getKeyId());
                
                log.info("å¯†é’¥è½®æ¢å®Œæˆ: {} -> {}", 
                    expiredKey.getKeyId(), newKey.getKeyId());
            }
            
            log.info("å¯†é’¥è½®æ¢å®Œæˆï¼Œå…±è½®æ¢ {} ä¸ªå¯†é’¥", expiredKeys.size());
            
        } catch (Exception e) {
            log.error("å¯†é’¥è½®æ¢å¤±è´¥", e);
        }
    }
    
    /**
     * æ›´æ–°æ•°æ®åº“ä¸­çš„å¯†é’¥å¼•ç”¨
     */
    private void updateKeyReferences(String oldKeyId, String newKeyId) {
        // å®ç°å¯†é’¥å¼•ç”¨æ›´æ–°é€»è¾‘
        // è¿™é‡Œåº”è¯¥æ›´æ–°æ‰€æœ‰ä½¿ç”¨æ—§å¯†é’¥çš„æ•°æ®è®°å½•
    }
}

// RESTæ§åˆ¶å™¨
package com.example.quantumsecurity.controller;

import com.example.quantumsecurity.service.QuantumSecurityService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;
import org.springframework.validation.annotation.Validated;

import javax.validation.Valid;
import java.util.concurrent.CompletableFuture;

@RestController
@RequestMapping("/api/v1/quantum")
@Validated
public class QuantumSecurityController {
    
    @Autowired
    private QuantumSecurityService quantumService;
    
    /**
     * ç”Ÿæˆé‡å­å¯†é’¥API
     */
    @PostMapping("/keys/generate")
    @PreAuthorize("hasRole('ADMIN') or hasRole('KEY_MANAGER')")
    public CompletableFuture&lt;ResponseEntity&lt;QuantumKeyResponse&gt;&gt; generateKey(
            @Valid @RequestBody KeyGenerationRequest request) {
        
        return quantumService.generateQuantumKey(request)
            .thenApply(key -> ResponseEntity.ok(
                QuantumKeyResponse.builder()
                    .keyId(key.getKeyId())
                    .algorithm(key.getAlgorithm())
                    .status("ACTIVE")
                    .createdAt(key.getCreatedAt())
                    .build()
            ))
            .exceptionally(throwable -> {
                log.error("å¯†é’¥ç”ŸæˆAPIå¤±è´¥", throwable);
                return ResponseEntity.internalServerError()
                    .body(QuantumKeyResponse.builder()
                        .status("ERROR")
                        .error(throwable.getMessage())
                        .build());
            });
    }
    
    /**
     * æ‰¹é‡åŠ å¯†API
     */
    @PostMapping("/encrypt/batch")
    @PreAuthorize("hasRole('USER')")
    public CompletableFuture&lt;ResponseEntity&lt;BatchEncryptionResponse&gt;&gt; encryptBatch(
            @Valid @RequestBody BatchEncryptionRequest request) {
        
        return quantumService.encryptUserData(request.getData(), request.getKeyId())
            .thenApply(encryptedList -> ResponseEntity.ok(
                BatchEncryptionResponse.builder()
                    .encryptedCount(encryptedList.size())
                    .encryptedData(encryptedList)
                    .status("SUCCESS")
                    .build()
            ))
            .exceptionally(throwable -> {
                log.error("æ‰¹é‡åŠ å¯†APIå¤±è´¥", throwable);
                return ResponseEntity.internalServerError()
                    .body(BatchEncryptionResponse.builder()
                        .status("ERROR")
                        .error(throwable.getMessage())
                        .build());
            });
    }
    
    /**
     * å¥åº·æ£€æŸ¥API
     */
    @GetMapping("/health")
    public ResponseEntity&lt;HealthResponse&gt; healthCheck() {
        try {
            // æ£€æŸ¥é‡å­æœåŠ¡è¿æ¥çŠ¶æ€
            boolean isHealthy = quantumService.isServiceHealthy();
            
            return ResponseEntity.ok(
                HealthResponse.builder()
                    .status(isHealthy ? "HEALTHY" : "UNHEALTHY")
                    .timestamp(Instant.now())
                    .quantumServiceStatus(isHealthy ? "CONNECTED" : "DISCONNECTED")
                    .build()
            );
        } catch (Exception e) {
            return ResponseEntity.status(503)
                .body(HealthResponse.builder()
                    .status("UNHEALTHY")
                    .error(e.getMessage())
                    .timestamp(Instant.now())
                    .build());
        }
    }
}

// å¼‚å¸¸å¤„ç†
@ControllerAdvice
public class QuantumSecurityExceptionHandler {
    
    @ExceptionHandler(QuantumSecurityException.class)
    public ResponseEntity&lt;ErrorResponse&gt; handleQuantumSecurityException(
            QuantumSecurityException e) {
        return ResponseEntity.badRequest()
            .body(ErrorResponse.builder()
                .code("QUANTUM_SECURITY_ERROR")
                .message(e.getMessage())
                .timestamp(Instant.now())
                .build());
    }
}</code></pre>
                        </div>
                    </div>

                    <!-- Go å¾®æœåŠ¡ç¤ºä¾‹ -->
                    <div class="code-example p-8 bg-white/5 backdrop-blur-sm rounded-2xl border border-cyber-green/20" data-category="integration">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <i class="fab fa-golang text-cyber-green text-2xl mr-4"></i>
                                <div>
                                    <h3 class="text-xl font-bold">Go - å¾®æœåŠ¡é›†æˆ</h3>
                                    <p class="text-gray-400">é«˜æ€§èƒ½å¾®æœåŠ¡é‡å­å®‰å…¨é›†æˆ</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="copy-btn px-3 py-1 bg-quantum-accent rounded text-white text-sm hover:bg-quantum-accent/80 transition-colors duration-300">
                                    <i class="fas fa-copy mr-1"></i>å¤åˆ¶
                                </button>
                                <button class="px-3 py-1 bg-quantum-secondary rounded text-white text-sm hover:bg-quantum-secondary/80 transition-colors duration-300">
                                    <i class="fas fa-download mr-1"></i>ä¸‹è½½
                                </button>
                            </div>
                        </div>
                        <div class="bg-black/50 rounded-lg overflow-hidden">
                            <pre class="p-4 text-sm overflow-x-auto"><code class="language-go">// Go å¾®æœåŠ¡é‡å­å®‰å…¨é›†æˆç¤ºä¾‹
package main

import (
    "context"
    "encoding/json"
    "fmt"
    "log"
    "net/http"
    "time"
    
    "github.com/alingai/go-sdk/quantum"
    "github.com/gin-gonic/gin"
    "github.com/go-redis/redis/v8"
    "gorm.io/gorm"
)

// é‡å­å®‰å…¨å¾®æœåŠ¡
type QuantumSecurityService struct {
    client     *quantum.Client
    keyManager *quantum.KeyManager
    redis      *redis.Client
    db         *gorm.DB
}

// åˆå§‹åŒ–æœåŠ¡
func NewQuantumSecurityService() *QuantumSecurityService {
    client := quantum.NewClient(&quantum.Config{
        APIKey:      getEnv("ALINGAI_API_KEY"),
        Endpoint:    getEnv("ALINGAI_ENDPOINT", "https://api.alingai.com"),
        Timeout:     30 * time.Second,
        MaxRetries:  3,
    })
    
    return &QuantumSecurityService{
        client:     client,
        keyManager: client.KeyManager(),
        redis:      initRedis(),
        db:         initDB(),
    }
}

// åŠ å¯†æ•°æ®ç»“æ„
type EncryptionRequest struct {
    Data     []byte                 `json:"data" binding:"required"`
    KeyID    string                 `json:"key_id" binding:"required"`
    Metadata map[string]interface{} `json:"metadata,omitempty"`
}

type EncryptionResponse struct {
    CipherText string    `json:"cipher_text"`
    KeyID      string    `json:"key_id"`
    Nonce      string    `json:"nonce"`
    Tag        string    `json:"tag"`
    CreatedAt  time.Time `json:"created_at"`
}

// é«˜æ€§èƒ½æ‰¹é‡åŠ å¯†
func (qs *QuantumSecurityService) BatchEncrypt(ctx context.Context, 
    requests []EncryptionRequest) ([]EncryptionResponse, error) {
    
    // ä½¿ç”¨ goroutine å¹¶å‘å¤„ç†
    results := make([]EncryptionResponse, len(requests))
    errChan := make(chan error, len(requests))
    
    for i, req := range requests {
        go func(index int, request EncryptionRequest) {
            defer func() {
                if r := recover(); r != nil {
                    errChan <- fmt.Errorf("encryption panic at index %d: %v", index, r)
                    return
                }
            }()
            
            // æ‰§è¡Œé‡å­åŠ å¯†
            encrypted, err := qs.client.Encrypt(ctx, &quantum.EncryptRequest{
                Data:      request.Data,
                KeyID:     request.KeyID,
                Algorithm: "AES-256-GCM-QUANTUM",
                Metadata:  request.Metadata,
            })
            
            if err != nil {
                errChan <- fmt.Errorf("encryption failed at index %d: %w", index, err)
                return
            }
            
            results[index] = EncryptionResponse{
                CipherText: encrypted.CipherText,
                KeyID:      encrypted.KeyID,
                Nonce:      encrypted.Nonce,
                Tag:        encrypted.Tag,
                CreatedAt:  time.Now(),
            }
            
            errChan <- nil
        }(i, req)
    }
    
    // ç­‰å¾…æ‰€æœ‰ goroutine å®Œæˆ
    for i := 0; i < len(requests); i++ {
        if err := <-errChan; err != nil {
            return nil, err
        }
    }
    
    log.Printf("æ‰¹é‡åŠ å¯†å®Œæˆï¼Œå¤„ç† %d æ¡æ•°æ®", len(requests))
    return results, nil
}

// å¯†é’¥ç¼“å­˜ç®¡ç†
func (qs *QuantumSecurityService) GetCachedKey(ctx context.Context, keyID string) (*quantum.Key, error) {
    // å…ˆä» Redis ç¼“å­˜è·å–
    cacheKey := fmt.Sprintf("quantum:key:%s", keyID)
    cached, err := qs.redis.Get(ctx, cacheKey).Result()
    
    if err == nil {
        var key quantum.Key
        if err := json.Unmarshal([]byte(cached), &key); err == nil {
            return &key, nil
        }
    }
    
    // ç¼“å­˜æœªå‘½ä¸­ï¼Œä»APIè·å–
    key, err := qs.keyManager.GetKey(ctx, keyID)
    if err != nil {
        return nil, fmt.Errorf("failed to get key: %w", err)
    }
    
    // ç¼“å­˜å¯†é’¥ä¿¡æ¯ï¼ˆä¸åŒ…å«ç§é’¥ï¼‰
    cacheData := quantum.Key{
        ID:        key.ID,
        Algorithm: key.Algorithm,
        KeySize:   key.KeySize,
        Purpose:   key.Purpose,
        Status:    key.Status,
        CreatedAt: key.CreatedAt,
        // æ³¨æ„ï¼šä¸ç¼“å­˜ç§é’¥æ•°æ®
    }
    
    if data, err := json.Marshal(cacheData); err == nil {
        qs.redis.Set(ctx, cacheKey, data, time.Hour).Err()
    }
    
    return key, nil
}

// HTTPè·¯ç”±å¤„ç†å™¨
func (qs *QuantumSecurityService) SetupRoutes() *gin.Engine {
    r := gin.Default()
    
    // ä¸­é—´ä»¶
    r.Use(gin.Logger())
    r.Use(gin.Recovery())
    r.Use(qs.authMiddleware())
    r.Use(qs.rateLimitMiddleware())
    
    api := r.Group("/api/v1")
    {
        // ç”Ÿæˆå¯†é’¥
        api.POST("/keys", qs.generateKey)
        
        // å•ä¸ªåŠ å¯†
        api.POST("/encrypt", qs.encrypt)
        
        // æ‰¹é‡åŠ å¯†
        api.POST("/encrypt/batch", qs.batchEncrypt)
        
        // è§£å¯†
        api.POST("/decrypt", qs.decrypt)
        
        // å¥åº·æ£€æŸ¥
        api.GET("/health", qs.healthCheck)
        
        // å¯†é’¥ç®¡ç†
        keys := api.Group("/keys")
        {
            keys.GET("/:id", qs.getKey)
            keys.DELETE("/:id", qs.revokeKey)
            keys.POST("/:id/rotate", qs.rotateKey)
        }
    }
    
    return r
}

// ç”Ÿæˆå¯†é’¥å¤„ç†å™¨
func (qs *QuantumSecurityService) generateKey(c *gin.Context) {
    var req struct {
        Algorithm string                 `json:"algorithm" binding:"required"`
        KeySize   int                    `json:"key_size" binding:"required"`
        Purpose   string                 `json:"purpose" binding:"required"`
        Metadata  map[string]interface{} `json:"metadata,omitempty"`
    }
    
    if err := c.ShouldBindJSON(&req); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
        return
    }
    
    ctx, cancel := context.WithTimeout(c.Request.Context(), 30*time.Second)
    defer cancel()
    
    key, err := qs.keyManager.GenerateKey(ctx, &quantum.KeySpec{
        Algorithm: req.Algorithm,
        KeySize:   req.KeySize,
        Purpose:   quantum.ParsePurpose(req.Purpose),
        Metadata:  req.Metadata,
    })
    
    if err != nil {
        log.Printf("å¯†é’¥ç”Ÿæˆå¤±è´¥: %v", err)
        c.JSON(http.StatusInternalServerError, gin.H{"error": "å¯†é’¥ç”Ÿæˆå¤±è´¥"})
        return
    }
    
    // è®°å½•å¯†é’¥ç”Ÿæˆäº‹ä»¶
    go qs.logKeyGeneration(key.ID, c.ClientIP())
    
    c.JSON(http.StatusCreated, gin.H{
        "key_id":    key.ID,
        "algorithm": key.Algorithm,
        "key_size":  key.KeySize,
        "status":    key.Status,
        "created_at": key.CreatedAt,
    })
}

// æ‰¹é‡åŠ å¯†å¤„ç†å™¨
func (qs *QuantumSecurityService) batchEncrypt(c *gin.Context) {
    var req struct {
        Requests []EncryptionRequest `json:"requests" binding:"required"`
    }
    
    if err := c.ShouldBindJSON(&req); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
        return
    }
    
    // é™åˆ¶æ‰¹é‡å¤§å°
    if len(req.Requests) > 100 {
        c.JSON(http.StatusBadRequest, gin.H{"error": "æ‰¹é‡å¤§å°ä¸èƒ½è¶…è¿‡100"})
        return
    }
    
    ctx, cancel := context.WithTimeout(c.Request.Context(), 60*time.Second)
    defer cancel()
    
    results, err := qs.BatchEncrypt(ctx, req.Requests)
    if err != nil {
        log.Printf("æ‰¹é‡åŠ å¯†å¤±è´¥: %v", err)
        c.JSON(http.StatusInternalServerError, gin.H{"error": "æ‰¹é‡åŠ å¯†å¤±è´¥"})
        return
    }
    
    c.JSON(http.StatusOK, gin.H{
        "results": results,
        "count":   len(results),
        "status":  "success",
    })
}

// è®¤è¯ä¸­é—´ä»¶
func (qs *QuantumSecurityService) authMiddleware() gin.HandlerFunc {
    return func(c *gin.Context) {
        apiKey := c.GetHeader("X-API-Key")
        if apiKey == "" {
            c.JSON(http.StatusUnauthorized, gin.H{"error": "APIå¯†é’¥ç¼ºå¤±"})
            c.Abort()
            return
        }
        
        // éªŒè¯APIå¯†é’¥
        if !qs.validateAPIKey(apiKey) {
            c.JSON(http.StatusUnauthorized, gin.H{"error": "æ— æ•ˆçš„APIå¯†é’¥"})
            c.Abort()
            return
        }
        
        c.Next()
    }
}

// é™æµä¸­é—´ä»¶
func (qs *QuantumSecurityService) rateLimitMiddleware() gin.HandlerFunc {
    return func(c *gin.Context) {
        clientIP := c.ClientIP()
        key := fmt.Sprintf("rate_limit:%s", clientIP)
        
        // ä½¿ç”¨ Redis å®ç°ä»¤ç‰Œæ¡¶ç®—æ³•
        current, err := qs.redis.Incr(c.Request.Context(), key).Result()
        if err != nil {
            log.Printf("é™æµæ£€æŸ¥å¤±è´¥: %v", err)
            c.Next()
            return
        }
        
        if current == 1 {
            qs.redis.Expire(c.Request.Context(), key, time.Minute)
        }
        
        if current > 100 { // æ¯åˆ†é’Ÿ100æ¬¡è¯·æ±‚
            c.JSON(http.StatusTooManyRequests, gin.H{
                "error": "è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•",
            })
            c.Abort()
            return
        }
        
        c.Next()
    }
}

// å¥åº·æ£€æŸ¥
func (qs *QuantumSecurityService) healthCheck(c *gin.Context) {
    ctx, cancel := context.WithTimeout(c.Request.Context(), 5*time.Second)
    defer cancel()
    
    // æ£€æŸ¥é‡å­æœåŠ¡è¿æ¥
    healthy := true
    var issues []string
    
    if err := qs.client.Ping(ctx); err != nil {
        healthy = false
        issues = append(issues, "é‡å­æœåŠ¡è¿æ¥å¤±è´¥")
    }
    
    if err := qs.redis.Ping(ctx).Err(); err != nil {
        healthy = false
        issues = append(issues, "Redisè¿æ¥å¤±è´¥")
    }
    
    status := "healthy"
    if !healthy {
        status = "unhealthy"
    }
    
    c.JSON(http.StatusOK, gin.H{
        "status":    status,
        "timestamp": time.Now(),
        "issues":    issues,
        "version":   "1.0.0",
    })
}

// ä¸»å‡½æ•°
func main() {
    service := NewQuantumSecurityService()
    router := service.SetupRoutes()
    
    log.Println("ğŸš€ é‡å­å®‰å…¨å¾®æœåŠ¡å¯åŠ¨...")
    log.Println("ğŸ“¡ æœåŠ¡åœ°å€: http://localhost:8080")
    
    if err := router.Run(":8080"); err != nil {
        log.Fatal("æœåŠ¡å¯åŠ¨å¤±è´¥:", err)
    }
}</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- è·å–æ›´å¤šç¤ºä¾‹ -->
        <section class="py-20 bg-gradient-to-b from-transparent to-quantum-purple/20">
            <div class="container mx-auto px-6 text-center">
                <div class="bg-gradient-to-r from-quantum-primary/10 to-quantum-accent/10 backdrop-blur-xl rounded-2xl border border-quantum-primary/20 p-12">
                    <h2 class="text-3xl font-bold mb-6 text-white">è·å–æ›´å¤šç¤ºä¾‹</h2>
                    <p class="text-xl text-gray-300 mb-8">æŸ¥çœ‹å®Œæ•´çš„ä»£ç åº“å’Œæœ€ä½³å®è·µ</p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <a href="https://github.com/alingai/examples" class="px-8 py-4 bg-gradient-to-r from-quantum-primary to-quantum-secondary rounded-lg text-white font-semibold hover:shadow-lg transition-all duration-300" target="_blank">
                            <i class="fab fa-github mr-2"></i>GitHub ä»“åº“
                        </a>
                        <a href="/docs" class="px-8 py-4 border border-quantum-accent text-quantum-accent rounded-lg font-semibold hover:bg-quantum-accent hover:text-white transition-all duration-300">
                            <i class="fas fa-book mr-2"></i>æŠ€æœ¯æ–‡æ¡£
                        </a>
                        <a href="/tech-support.html" class="px-8 py-4 border border-quantum-secondary text-quantum-secondary rounded-lg font-semibold hover:bg-quantum-secondary hover:text-white transition-all duration-300">
                            <i class="fas fa-headset mr-2"></i>æŠ€æœ¯æ”¯æŒ
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- é¡µè„š -->
    <footer class="bg-black/50 backdrop-blur-xl border-t border-quantum-primary/20 py-8">
        <div class="container mx-auto px-6 text-center">
            <p class="text-gray-400 text-sm">Â© 2024 ç‘å‡Œç§‘æŠ€. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
        </div>
    </footer>

    <!-- è„šæœ¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // åˆ†ç±»è¿‡æ»¤åŠŸèƒ½
        document.querySelectorAll('.code-category-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.code-category-btn').forEach(b => {
                    b.classList.remove('active', 'bg-quantum-primary');
                    b.classList.add('bg-white/10', 'text-gray-300');
                });
                this.classList.add('active', 'bg-quantum-primary');
                this.classList.remove('bg-white/10', 'text-gray-300');
                
                // è¿‡æ»¤ç¤ºä¾‹
                const category = this.dataset.category;
                document.querySelectorAll('.code-example').forEach(example => {
                    if (category === 'all' || example.dataset.category === category) {
                        example.style.display = 'block';
                    } else {
                        example.style.display = 'none';
                    }
                });
            });
        });

        // å¤åˆ¶ä»£ç åŠŸèƒ½
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const codeBlock = this.closest('.code-example').querySelector('code');
                const text = codeBlock.textContent;
                
                navigator.clipboard.writeText(text).then(() => {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check mr-1"></i>å·²å¤åˆ¶';
                    this.classList.add('bg-green-500');
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.classList.remove('bg-green-500');
                    }, 2000);
                });
            });
        });
    </script>
</body>
</html>
