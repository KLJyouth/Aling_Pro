class FixVerification{constructor(){this.testResults={themeSwitch:{status: 'pending',message: 'å¾…æµ‹è¯•'},contactForm:{status: 'pending',message: 'å¾…æµ‹è¯•'},aiAssistant:{status: 'pending',message: 'å¾…æµ‹è¯•'},emailService:{status: 'pending',message: 'å¾…æµ‹è¯•'},chatAPI:{status: 'pending',message: 'å¾…æµ‹è¯•'}};this.init();}async init(){console.log('ðŸ” å¼€å§‹åŠŸèƒ½ä¿®å¤éªŒè¯...');if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=> this.runTests());}else{this.runTests();}}async runTests(){console.log('ðŸ§ª å¼€å§‹è¿è¡Œæµ‹è¯•...');try{await this.testThemeSwitch();await this.testContactForm();await this.testAIAssistant();await this.testEmailService();await this.testChatAPI();this.displayResults();}catch(error){console.error('âŒ æµ‹è¯•è¿‡ç¨‹ä¸­å‡ºçŽ°é”™è¯¯:',error);}}async testThemeSwitch(){console.log('ðŸŽ¨ æµ‹è¯•ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½...');try{const themeButton=document.querySelector('.theme-toggle-btn');if(!themeButton){throw new Error('ä¸»é¢˜åˆ‡æ¢æŒ‰é’®æœªæ‰¾åˆ°');}if(!window.homepageFixes){throw new Error('HomepageFixesç±»æœªåŠ è½½');}const initialTheme=window.homepageFixes.currentTheme;window.homepageFixes.toggleTheme();const newTheme=window.homepageFixes.currentTheme;if(initialTheme !==newTheme){this.testResults.themeSwitch={status: 'success',message: `ä¸»é¢˜åˆ‡æ¢æˆåŠŸ: ${initialTheme}â†’ ${newTheme}`};}else{throw new Error('ä¸»é¢˜åˆ‡æ¢å¤±è´¥');}}catch(error){this.testResults.themeSwitch={status: 'error',message: error.message};}}async testContactForm(){console.log('ðŸ“§ æµ‹è¯•è”ç³»è¡¨å•åŠŸèƒ½...');try{const contactForm=document.getElementById('contactForm');if(!contactForm){throw new Error('è”ç³»è¡¨å•æœªæ‰¾åˆ°');}const requiredFields=['name','email','message'];for(let field of requiredFields){const input=contactForm.querySelector(`[name="${field}"]`);if(!input){throw new Error(`ç¼ºå°‘å¿…å¡«å­—æ®µ: ${field}`);}}if(!window.homepageFixes || typeof window.homepageFixes.handleContactFormSubmit !=='function'){throw new Error('è”ç³»è¡¨å•å¤„ç†å‡½æ•°æœªæ‰¾åˆ°');}this.testResults.contactForm={status: 'success',message: 'è”ç³»è¡¨å•ç»“æž„å’Œå¤„ç†å‡½æ•°æ­£å¸¸'};}catch(error){this.testResults.contactForm={status: 'error',message: error.message};}}async testAIAssistant(){console.log('ðŸ¤– æµ‹è¯•AIåŠ©æ‰‹åŠŸèƒ½...');try{const chatButton=document.querySelector('.chat-toggle-btn');if(!chatButton){throw new Error('AIåŠ©æ‰‹èŠå¤©æŒ‰é’®æœªæ‰¾åˆ°');}const chatModal=document.getElementById('chatModal');if(!chatModal){throw new Error('AIåŠ©æ‰‹èŠå¤©æ¨¡æ€æ¡†æœªæ‰¾åˆ°');}if(!window.homepageFixes || !window.homepageFixes.chatSystem){throw new Error('AIåŠ©æ‰‹èŠå¤©ç³»ç»Ÿæœªåˆå§‹åŒ–');}this.testResults.aiAssistant={status: 'success',message: 'AIåŠ©æ‰‹ç•Œé¢å’Œç³»ç»Ÿæ­£å¸¸'};}catch(error){this.testResults.aiAssistant={status: 'error',message: error.message};}}async testEmailService(){console.log('ðŸ“® æµ‹è¯•é‚®ä»¶æœåŠ¡é…ç½®...');try{const testData={name: 'æµ‹è¯•ç”¨æˆ·',email: 'test@example.com',message: 'è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯'};const response=await fetch('/api/contact.php',{method: 'POST',headers:{'Content-Type': 'application/json',},body: JSON.stringify(testData)});if(!response.ok){throw new Error(`HTTPé”™è¯¯: ${response.status}`);}const result=await response.json();this.testResults.emailService={status: result.success ? 'success' : 'warning',message: result.message ||(result.success ? 'é‚®ä»¶æœåŠ¡æ­£å¸¸' : 'é‚®ä»¶æœåŠ¡é…ç½®å¯èƒ½æœ‰é—®é¢˜')};}catch(error){this.testResults.emailService={status: 'error',message: `é‚®ä»¶æœåŠ¡æµ‹è¯•å¤±è´¥: ${error.message}`};}}async testChatAPI(){console.log('ðŸ’¬ æµ‹è¯•èŠå¤©API...');try{const testMessage='ä½ å¥½ï¼Œè¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯';const response=await fetch('/api/chat.php',{method: 'POST',headers:{'Content-Type': 'application/json',},body: JSON.stringify({message: testMessage})});if(!response.ok){throw new Error(`HTTPé”™è¯¯: ${response.status}`);}const result=await response.json();if(result.success && result.response){this.testResults.chatAPI={status: 'success',message: `èŠå¤©APIæ­£å¸¸ï¼Œå›žå¤: ${result.response.substring(0,50)}...`};}else{throw new Error(result.message || 'èŠå¤©APIè¿”å›žå¼‚å¸¸');}}catch(error){this.testResults.chatAPI={status: 'error',message: `èŠå¤©APIæµ‹è¯•å¤±è´¥: ${error.message}`};}}displayResults(){console.log('ðŸ“Š æµ‹è¯•ç»“æžœæ±‡æ€»:');console.log('==========================================');let totalTests=0;let passedTests=0;let warningTests=0;for(const [testName,result] of Object.entries(this.testResults)){totalTests++;let icon='âŒ';if(result.status==='success'){icon='âœ…';passedTests++;}else if(result.status==='warning'){icon='âš ï¸';warningTests++;}console.log(`${icon}${testName}: ${result.message}`);}console.log('==========================================');console.log(`ðŸ“ˆ æµ‹è¯•ç»Ÿè®¡: ${passedTests}/${totalTests}é€šè¿‡`);if(warningTests > 0){console.log(`âš ï¸ ${warningTests}ä¸ªæµ‹è¯•æœ‰è­¦å‘Š`);}if(passedTests===totalTests){console.log('ðŸŽ‰ æ‰€æœ‰åŠŸèƒ½ä¿®å¤éªŒè¯é€šè¿‡ï¼');this.createSuccessReport();}else if(passedTests+warningTests===totalTests){console.log('âœ… ä¸»è¦åŠŸèƒ½ä¿®å¤å®Œæˆï¼Œæœ‰éƒ¨åˆ†è­¦å‘Š');this.createWarningReport();}else{console.log('âš ï¸ éƒ¨åˆ†åŠŸèƒ½ä¿®å¤å¤±è´¥ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥');this.createErrorReport();}}createSuccessReport(){const report={timestamp: new Date().toISOString(),status: 'success',summary: 'æ‰€æœ‰åŠŸèƒ½ä¿®å¤éªŒè¯é€šè¿‡',details: this.testResults,fixes_completed: [ 'âœ… è”ç³»è¡¨å•é‚®ä»¶å‘é€åŠŸèƒ½å·²ä¿®å¤','âœ… ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½å·²å®žçŽ°','âœ… AIæ™ºèƒ½åŠ©æ‰‹èŠå¤©åŠŸèƒ½å·²ä¿®å¤','âœ… é‚®ä»¶æœåŠ¡é…ç½®å·²æ›´æ–°','âœ… èŠå¤©APIå·²ä¼˜åŒ–' ],next_steps: [ 'ðŸ“§ é…ç½®çœŸå®žçš„é‚®ä»¶æœåŠ¡å™¨è®¾ç½®','ðŸ¤– æŽ¥å…¥çœŸå®žçš„AIæœåŠ¡API','ðŸŽ¨ ä¼˜åŒ–ä¸»é¢˜åˆ‡æ¢åŠ¨ç”»æ•ˆæžœ','ðŸ“± æµ‹è¯•ç§»åŠ¨ç«¯å“åº”å¼é€‚é…','ðŸ”’ æ·»åŠ å®‰å…¨éªŒè¯æœºåˆ¶' ]};console.log('ðŸ“‹ ç”ŸæˆæˆåŠŸæŠ¥å‘Š:',report);this.showStatusMessage('success','ðŸŽ‰ æ‰€æœ‰åŠŸèƒ½ä¿®å¤éªŒè¯é€šè¿‡ï¼');}createWarningReport(){const report={timestamp: new Date().toISOString(),status: 'warning',summary: 'ä¸»è¦åŠŸèƒ½ä¿®å¤å®Œæˆï¼Œæœ‰éƒ¨åˆ†è­¦å‘Š',details: this.testResults,warnings: Object.entries(this.testResults).filter(([_,result])=> result.status==='warning').map(([name,result])=> `${name}: ${result.message}`)};console.log('âš ï¸ ç”Ÿæˆè­¦å‘ŠæŠ¥å‘Š:',report);this.showStatusMessage('warning','âœ… ä¸»è¦åŠŸèƒ½ä¿®å¤å®Œæˆï¼Œè¯·æ£€æŸ¥è­¦å‘Šé¡¹');}createErrorReport(){const report={timestamp: new Date().toISOString(),status: 'error',summary: 'éƒ¨åˆ†åŠŸèƒ½ä¿®å¤å¤±è´¥',details: this.testResults,errors: Object.entries(this.testResults).filter(([_,result])=> result.status==='error').map(([name,result])=> `${name}: ${result.message}`)};console.log('âŒ ç”Ÿæˆé”™è¯¯æŠ¥å‘Š:',report);this.showStatusMessage('error','âš ï¸ éƒ¨åˆ†åŠŸèƒ½ä¿®å¤å¤±è´¥ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥');}showStatusMessage(type,message){const statusDiv=document.createElement('div');statusDiv.style.cssText=` position: fixed;top: 20px;left: 50%;transform: translateX(-50%);z-index: 10000;padding: 15px 25px;border-radius: 10px;color: white;font-weight: bold;box-shadow: 0 5px 20px rgba(0,0,0,0.3);backdrop-filter: blur(10px);animation: slideDown 0.5s ease;`;switch(type){case 'success': statusDiv.style.background='linear-gradient(135deg,#10b981 0%,#059669 100%)';break;case 'warning': statusDiv.style.background='linear-gradient(135deg,#f59e0b 0%,#d97706 100%)';break;case 'error': statusDiv.style.background='linear-gradient(135deg,#ef4444 0%,#dc2626 100%)';break;}statusDiv.textContent=message;document.body.appendChild(statusDiv);setTimeout(()=>{if(statusDiv.parentNode){statusDiv.style.animation='slideUp 0.5s ease';setTimeout(()=> statusDiv.remove(),500);}},5000);if(!document.querySelector('#verification-animations')){const style=document.createElement('style');style.id='verification-animations';style.textContent=` @keyframes slideDown{from{opacity: 0;transform: translateX(-50%)translateY(-20px);}to{opacity: 1;transform: translateX(-50%)translateY(0);}}@keyframes slideUp{from{opacity: 1;transform: translateX(-50%)translateY(0);}to{opacity: 0;transform: translateX(-50%)translateY(-20px);}}`;document.head.appendChild(style);}}}document.addEventListener('DOMContentLoaded',()=>{setTimeout(()=>{window.fixVerification=new FixVerification();},1000);});window.FixVerification=FixVerification;