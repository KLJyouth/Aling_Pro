// é›†æˆç³»ç»ŸéªŒè¯å™¨ // æ£€æŸ¥æ‰€æœ‰ç»„ä»¶å’ŒåŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ // åˆ›å»ºæ—¶é—´: 2025-05-30 console.log('ğŸ” å¯åŠ¨é›†æˆç³»ç»ŸéªŒè¯å™¨...'); class IntegratedSystemValidator { constructor() { this.testResults = []; this.errors = []; this.warnings = []; // è‡ªåŠ¨å¯åŠ¨éªŒè¯ setTimeout(() => { this.runFullValidation(); }, 2000); } async runFullValidation() { console.log('ğŸ§ª å¼€å§‹å®Œæ•´ç³»ç»ŸéªŒè¯...'); // 1. éªŒè¯æ ¸å¿ƒè„šæœ¬åŠ è½½ this.validateScriptLoading(); // 2. éªŒè¯DOMå…ƒç´  this.validateDOMElements(); // 3. éªŒè¯åŠŸèƒ½æŒ‰é’® this.validateButtons(); // 4. éªŒè¯ä¸‹æ‹‰èœå• this.validateDropdownMenus(); // 5. éªŒè¯èŠå¤©æ ¸å¿ƒç±» this.validateChatClasses(); // 6. éªŒè¯é”™è¯¯å¤„ç†å™¨ this.validateErrorHandlers(); // 7. éªŒè¯éŸ³é¢‘ç³»ç»Ÿ this.validateAudioSystem(); // 8. éªŒè¯æ–°å¢åŠŸèƒ½ç³»ç»Ÿ this.validateNewFeatureSystems(); // 9. ç”ŸæˆéªŒè¯æŠ¥å‘Š this.generateValidationReport(); } validateScriptLoading() { console.log('ğŸ“ éªŒè¯è„šæœ¬åŠ è½½çŠ¶æ€...'); const requiredScripts = [ 'SystemErrorHandler', 'ConsoleOptimizer', 'PerformanceMonitor', 'MessageProcessor', 'MessageRenderer', 'ChatCore', 'NotificationSystem', 'VisualizationDashboard', 'ApiIntegration', 'TeamCollaboration', 'IntelligentAlertSystem' ]; requiredScripts.forEach(scriptClass => { if (typeof window[scriptClass] !== 'undefined') { this.addResult('âœ…', `${scriptClass} ç±»å·²åŠ è½½`); } else { this.addError('âŒ', `${scriptClass} ç±»æœªæ‰¾åˆ°`); } }); // æ£€æŸ¥å…¨å±€å®ä¾‹ if (window.chatInstance) { this.addResult('âœ…', 'chatInstance å…¨å±€å®ä¾‹å·²åˆ›å»º'); } else { this.addError('âŒ', 'chatInstance å…¨å±€å®ä¾‹æœªåˆ›å»º'); } } validateDOMElements() { console.log('ğŸ¯ éªŒè¯DOMå…ƒç´ ...'); const requiredElements = [ { id: 'quickDetectionBtn', name: 'å¿«é€Ÿæ£€æµ‹æŒ‰é’®' }, { id: 'fullDetectionBtn', name: 'å®Œæ•´æ£€æµ‹æŒ‰é’®' }, { id: 'analysisReportBtn', name: 'åˆ†ææŠ¥å‘ŠæŒ‰é’®' }, { id: 'systemStatusBtn', name: 'ç³»ç»ŸçŠ¶æ€æŒ‰é’®' }, { id: 'toolsDropdown', name: 'å·¥å…·ä¸‹æ‹‰èœå•' }, { id: 'detectionResults', name: 'æ£€æµ‹ç»“æœåŒºåŸŸ' }, { id: 'chatTestElements', name: 'èŠå¤©æµ‹è¯•å…ƒç´ å®¹å™¨' }, { id: 'loginModal', name: 'ç™»å½•æ¨¡æ€æ¡†' }, { id: 'messageInput', name: 'æ¶ˆæ¯è¾“å…¥æ¡†' }, { id: 'chatMessages', name: 'èŠå¤©æ¶ˆæ¯åŒºåŸŸ' }, // æ–°å¢åŠ¨ç”»ç³»ç»Ÿå…ƒç´  { id: 'quantumParticles', name: 'é‡å­ç²’å­ç³»ç»Ÿ' }, { id: 'orbitalContainer', name: 'è½¨é“å®¹å™¨' }, { id: 'matrixEffect', name: 'çŸ©é˜µæ•ˆæœ' }, { id: 'quantumLoader', name: 'é‡å­åŠ è½½å™¨' }, // æ–°å¢èŠå¤©åŠŸèƒ½å…ƒç´  { id: 'chatWidget', name: 'èŠå¤©ç»„ä»¶' }, { id: 'chatInput', name: 'èŠå¤©è¾“å…¥æ¡†' }, // æ–°å¢æ— éšœç¢åŠŸèƒ½å…ƒç´  { id: 'accessibilityToolbar', name: 'æ— éšœç¢å·¥å…·æ ' }, { id: 'fontSizeUp', name: 'å­—ä½“æ”¾å¤§æŒ‰é’®' }, { id: 'fontSizeDown', name: 'å­—ä½“ç¼©å°æŒ‰é’®' }, { id: 'toggleContrast', name: 'å¯¹æ¯”åº¦åˆ‡æ¢æŒ‰é’®' }, { id: 'toggleScreenReader', name: 'å±å¹•é˜…è¯»å™¨åˆ‡æ¢æŒ‰é’®' } ]; requiredElements.forEach(element => { const domElement = document.getElementById(element.id); if (domElement) { this.addResult('âœ…', `${element.name} å…ƒç´ å­˜åœ¨`); } else { this.addError('âŒ', `${element.name} å…ƒç´ ç¼ºå¤±`); } }); } validateButtons() { console.log('ğŸ”˜ éªŒè¯æŒ‰é’®åŠŸèƒ½...'); const buttons = [ { id: 'quickDetectionBtn', name: 'å¿«é€Ÿæ£€æµ‹' }, { id: 'fullDetectionBtn', name: 'å®Œæ•´æ£€æµ‹' }, { id: 'analysisReportBtn', name: 'åˆ†ææŠ¥å‘Š' }, { id: 'systemStatusBtn', name: 'ç³»ç»ŸçŠ¶æ€' } ]; buttons.forEach(button => { const btn = document.getElementById(button.id); if (btn) { // æ£€æŸ¥äº‹ä»¶ç›‘å¬å™¨ const hasEventListener = btn.onclick !== null || btn.getAttribute('onclick'); if (hasEventListener) { this.addResult('âœ…', `${button.name}æŒ‰é’®æœ‰äº‹ä»¶å¤„ç†å™¨`); } else { this.addWarning('âš ï¸', `${button.name}æŒ‰é’®ç¼ºå°‘äº‹ä»¶å¤„ç†å™¨`); } // æ£€æŸ¥æ ·å¼ const isVisible = window.getComputedStyle(btn).display !== 'none'; if (isVisible) { this.addResult('âœ…', `${button.name}æŒ‰é’®å¯è§`); } else { this.addWarning('âš ï¸', `${button.name}æŒ‰é’®ä¸å¯è§`); } } }); } validateDropdownMenus() { console.log('ğŸ“‹ éªŒè¯ä¸‹æ‹‰èœå•...'); const dropdown = document.getElementById('toolsDropdown'); if (dropdown) { // æ£€æŸ¥Bootstrapä¸‹æ‹‰èœå• const hasBootstrapToggle = dropdown.getAttribute('data-bs-toggle') === 'dropdown'; if (hasBootstrapToggle) { this.addResult('âœ…', 'å·¥å…·ä¸‹æ‹‰èœå•é…ç½®æ­£ç¡®'); } else { this.addError('âŒ', 'å·¥å…·ä¸‹æ‹‰èœå•é…ç½®é”™è¯¯'); } // æ£€æŸ¥ä¸‹æ‹‰èœå•é¡¹ const dropdownMenu = dropdown.nextElementSibling; if (dropdownMenu && dropdownMenu.classList.contains('dropdown-menu')) { const menuItems = dropdownMenu.querySelectorAll('.dropdown-item'); if (menuItems.length > 0) { this.addResult('âœ…', `å·¥å…·ä¸‹æ‹‰èœå•åŒ…å« ${menuItems.length} ä¸ªé€‰é¡¹`); } else { this.addWarning('âš ï¸', 'å·¥å…·ä¸‹æ‹‰èœå•é€‰é¡¹ä¸ºç©º'); } } } } validateChatClasses() { console.log('ğŸ’¬ éªŒè¯èŠå¤©æ ¸å¿ƒç±»...'); try { if (window.chatInstance) { const { core, processor, ui, api } = window.chatInstance; if (core) this.addResult('âœ…', 'ChatCore å®ä¾‹å­˜åœ¨'); else this.addError('âŒ', 'ChatCore å®ä¾‹ç¼ºå¤±'); if (processor) this.addResult('âœ…', 'MessageProcessor å®ä¾‹å­˜åœ¨'); else this.addError('âŒ', 'MessageProcessor å®ä¾‹ç¼ºå¤±'); if (ui) this.addResult('âœ…', 'UI æ–¹æ³•é›†åˆå­˜åœ¨'); else this.addError('âŒ', 'UI æ–¹æ³•é›†åˆç¼ºå¤±'); if (api) this.addResult('âœ…', 'API æ–¹æ³•é›†åˆå­˜åœ¨'); else this.addError('âŒ', 'API æ–¹æ³•é›†åˆç¼ºå¤±'); } } catch (error) { this.addError('âŒ', `èŠå¤©æ ¸å¿ƒç±»éªŒè¯å¤±è´¥: ${error.message}`); } } validateErrorHandlers() { console.log('ğŸ›¡ï¸ éªŒè¯é”™è¯¯å¤„ç†å™¨...'); if (window.systemErrorHandler) { this.addResult('âœ…', 'ç³»ç»Ÿé”™è¯¯å¤„ç†å™¨å·²å¯åŠ¨'); } else { this.addError('âŒ', 'ç³»ç»Ÿé”™è¯¯å¤„ç†å™¨æœªå¯åŠ¨'); } if (window.consoleOptimizer) { this.addResult('âœ…', 'æ§åˆ¶å°ä¼˜åŒ–å™¨å·²å¯åŠ¨'); } else { this.addError('âŒ', 'æ§åˆ¶å°ä¼˜åŒ–å™¨æœªå¯åŠ¨'); } if (window.performanceMonitor) { this.addResult('âœ…', 'æ€§èƒ½ç›‘æ§å™¨å·²å¯åŠ¨'); } else { this.addError('âŒ', 'æ€§èƒ½ç›‘æ§å™¨æœªå¯åŠ¨'); } } validateAudioSystem() { console.log('ğŸ”Š éªŒè¯éŸ³é¢‘ç³»ç»Ÿ...'); // æ£€æŸ¥éŸ³é¢‘ä¸Šä¸‹æ–‡åˆå§‹åŒ–ç­–ç•¥ if (window.soundManager) { this.addResult('âœ…', 'éŸ³é¢‘ç®¡ç†å™¨å­˜åœ¨'); // æ£€æŸ¥æ˜¯å¦æœ‰å»¶è¿Ÿåˆå§‹åŒ– if (window.soundManager.pendingAudioInit !== undefined) { this.addResult('âœ…', 'éŸ³é¢‘å»¶è¿Ÿåˆå§‹åŒ–ç­–ç•¥å·²å®æ–½'); } else { this.addWarning('âš ï¸', 'éŸ³é¢‘å»¶è¿Ÿåˆå§‹åŒ–ç­–ç•¥å¯èƒ½ç¼ºå¤±'); } } else { this.addWarning('âš ï¸', 'éŸ³é¢‘ç®¡ç†å™¨æœªæ‰¾åˆ°'); } } validateNewFeatureSystems() { console.log('ğŸš€ éªŒè¯æ–°å¢åŠŸèƒ½ç³»ç»Ÿ...'); // 1. éªŒè¯å‰ç«¯å¢å¼ºåŠŸèƒ½ç±» const frontendEnhancementClasses = [ { name: 'AnimationSystem', description: 'åŠ¨ç”»ç³»ç»Ÿ' }, { name: 'ChatSystem', description: 'èŠå¤©ç³»ç»Ÿ' }, { name: 'AccessibilitySystem', description: 'æ— éšœç¢ç³»ç»Ÿ' }, { name: 'FrontendResourceManager', description: 'å‰ç«¯èµ„æºç®¡ç†å™¨' } ]; frontendEnhancementClasses.forEach(cls => { if (typeof window[cls.name] !== 'undefined') { this.addResult('âœ…', `${cls.description} (${cls.name}) ç±»å·²åŠ è½½`); } else { this.addError('âŒ', `${cls.description} (${cls.name}) ç±»æœªæ‰¾åˆ°`); } }); // 2. éªŒè¯ç½‘ç«™çŠ¶æ€å’Œé›†æˆæµ‹è¯•ç±» const integrationClasses = [ { name: 'WebsiteStatusMonitor', description: 'ç½‘ç«™çŠ¶æ€ç›‘æ§å™¨' }, { name: 'ComprehensiveIntegrationTester', description: 'ç»¼åˆé›†æˆæµ‹è¯•å™¨' } ]; integrationClasses.forEach(cls => { if (typeof window[cls.name] !== 'undefined') { this.addResult('âœ…', `${cls.description} (${cls.name}) ç±»å·²åŠ è½½`); } else { this.addError('âŒ', `${cls.description} (${cls.name}) ç±»æœªæ‰¾åˆ°`); } }); // 3. éªŒè¯å…¨å±€å®ä¾‹åˆ›å»º const globalInstances = [ { name: 'frontendResourceManager', description: 'å‰ç«¯èµ„æºç®¡ç†å™¨å®ä¾‹' }, { name: 'websiteMonitor', description: 'ç½‘ç«™ç›‘æ§å™¨å®ä¾‹' }, { name: 'integrationTester', description: 'é›†æˆæµ‹è¯•å™¨å®ä¾‹' } ]; globalInstances.forEach(instance => { if (window[instance.name]) { this.addResult('âœ…', `${instance.description}å·²åˆ›å»º`); } else { this.addWarning('âš ï¸', `${instance.description}å¯èƒ½æœªåˆ›å»º`); } }); // 4. éªŒè¯åŠ¨ç”»ç³»ç»ŸåŠŸèƒ½ this.validateAnimationSystemFeatures(); // 5. éªŒè¯èŠå¤©ç³»ç»ŸåŠŸèƒ½ this.validateChatSystemFeatures(); // 6. éªŒè¯æ— éšœç¢ç³»ç»ŸåŠŸèƒ½ this.validateAccessibilityFeatures(); // 7. éªŒè¯å·¥å…·èœå•æ–°å¢é¡¹ this.validateToolMenuExtensions(); } validateAnimationSystemFeatures() { console.log('ğŸ¨ éªŒè¯åŠ¨ç”»ç³»ç»ŸåŠŸèƒ½...'); // æ£€æŸ¥åŠ¨ç”»ç›¸å…³DOMå…ƒç´  const animationElements = ['quantumParticles', 'orbitalContainer', 'matrixEffect', 'quantumLoader']; animationElements.forEach(id => { const element = document.getElementById(id); if (element) { this.addResult('âœ…', `åŠ¨ç”»å…ƒç´  ${id} å­˜åœ¨`); // æ£€æŸ¥Canvaså…ƒç´  if (id === 'quantumParticles' || id === 'matrixEffect') { const canvas = element.querySelector('canvas'); if (canvas) { this.addResult('âœ…', `${id} Canvas å…ƒç´ å­˜åœ¨`); } else { this.addWarning('âš ï¸', `${id} Canvas å…ƒç´ ç¼ºå¤±`); } } } else { this.addError('âŒ', `åŠ¨ç”»å…ƒç´  ${id} ç¼ºå¤±`); } }); // æ£€æŸ¥åŠ¨ç”»CSSæ ·å¼ const hasAnimationStyles = document.querySelector('style') && document.querySelector('style').textContent.includes('@keyframes'); if (hasAnimationStyles) { this.addResult('âœ…', 'åŠ¨ç”»CSSæ ·å¼å·²åŠ è½½'); } else { this.addWarning('âš ï¸', 'åŠ¨ç”»CSSæ ·å¼å¯èƒ½ç¼ºå¤±'); } } validateChatSystemFeatures() { console.log('ğŸ’¬ éªŒè¯èŠå¤©ç³»ç»ŸåŠŸèƒ½...'); // æ£€æŸ¥èŠå¤©ç›¸å…³DOMå…ƒç´  const chatElements = ['chatWidget', 'chatMessages', 'chatInput', 'chatToggleBtn']; chatElements.forEach(id => { const element = document.getElementById(id); if (element) { this.addResult('âœ…', `èŠå¤©å…ƒç´  ${id} å­˜åœ¨`); // æ£€æŸ¥äº‹ä»¶å¤„ç†å™¨ if (id === 'chatToggleBtn' && element.onclick) { this.addResult('âœ…', 'èŠå¤©åˆ‡æ¢æŒ‰é’®æœ‰äº‹ä»¶å¤„ç†å™¨'); } } else { this.addError('âŒ', `èŠå¤©å…ƒç´  ${id} ç¼ºå¤±`); } }); // æ£€æŸ¥èŠå¤©æ ·å¼ const chatWidget = document.getElementById('chatWidget'); if (chatWidget) { const computedStyle = window.getComputedStyle(chatWidget); if (computedStyle.position === 'fixed') { this.addResult('âœ…', 'èŠå¤©çª—å£å®šä½æ ·å¼æ­£ç¡®'); } else { this.addWarning('âš ï¸', 'èŠå¤©çª—å£å®šä½æ ·å¼å¯èƒ½ä¸æ­£ç¡®'); } } } validateAccessibilityFeatures() { console.log('â™¿ éªŒè¯æ— éšœç¢ç³»ç»ŸåŠŸèƒ½...'); // æ£€æŸ¥æ— éšœç¢ç›¸å…³DOMå…ƒç´  const accessibilityElements = [ 'accessibilityToolbar', 'fontSizeUp', 'fontSizeDown', 'toggleContrast', 'toggleScreenReader' ]; accessibilityElements.forEach(id => { const element = document.getElementById(id); if (element) { this.addResult('âœ…', `æ— éšœç¢å…ƒç´  ${id} å­˜åœ¨`); // æ£€æŸ¥æŒ‰é’®çš„å¯è®¿é—®æ€§å±æ€§ if (element.tagName === 'BUTTON') { if (element.getAttribute('aria-label')) { this.addResult('âœ…', `${id} æœ‰ aria-label å±æ€§`); } else { this.addWarning('âš ï¸', `${id} ç¼ºå°‘ aria-label å±æ€§`); } if (element.getAttribute('title')) { this.addResult('âœ…', `${id} æœ‰ title å±æ€§`); } else { this.addWarning('âš ï¸', `${id} ç¼ºå°‘ title å±æ€§`); } } } else { this.addError('âŒ', `æ— éšœç¢å…ƒç´  ${id} ç¼ºå¤±`); } }); // æ£€æŸ¥æ— éšœç¢CSSç±» const hasAccessibilityStyles = document.querySelector('style') && document.querySelector('style').textContent.includes('.high-contrast'); if (hasAccessibilityStyles) { this.addResult('âœ…', 'æ— éšœç¢CSSæ ·å¼å·²åŠ è½½'); } else { this.addWarning('âš ï¸', 'æ— éšœç¢CSSæ ·å¼å¯èƒ½ç¼ºå¤±'); } } validateToolMenuExtensions() { console.log('ğŸ”§ éªŒè¯å·¥å…·èœå•æ‰©å±•...'); const toolsDropdown = document.getElementById('toolsDropdown'); if (toolsDropdown) { const dropdownMenu = toolsDropdown.nextElementSibling; if (dropdownMenu) { // æ£€æŸ¥ç½‘ç«™çŠ¶æ€æ£€æŸ¥èœå•é¡¹ const statusCheckItem = Array.from(dropdownMenu.querySelectorAll('a')) .find(a => a.textContent.includes('ç½‘ç«™çŠ¶æ€æ£€æŸ¥')); if (statusCheckItem) { this.addResult('âœ…', 'ç½‘ç«™çŠ¶æ€æ£€æŸ¥èœå•é¡¹å­˜åœ¨'); if (statusCheckItem.getAttribute('onclick')) { this.addResult('âœ…', 'ç½‘ç«™çŠ¶æ€æ£€æŸ¥æœ‰äº‹ä»¶å¤„ç†å™¨'); } else { this.addWarning('âš ï¸', 'ç½‘ç«™çŠ¶æ€æ£€æŸ¥ç¼ºå°‘äº‹ä»¶å¤„ç†å™¨'); } } else { this.addError('âŒ', 'ç½‘ç«™çŠ¶æ€æ£€æŸ¥èœå•é¡¹ç¼ºå¤±'); } // æ£€æŸ¥é›†æˆæµ‹è¯•èœå•é¡¹ const integrationTestItem = Array.from(dropdownMenu.querySelectorAll('a')) .find(a => a.textContent.includes('é›†æˆæµ‹è¯•')); if (integrationTestItem) { this.addResult('âœ…', 'é›†æˆæµ‹è¯•èœå•é¡¹å­˜åœ¨'); if (integrationTestItem.getAttribute('onclick')) { this.addResult('âœ…', 'é›†æˆæµ‹è¯•æœ‰äº‹ä»¶å¤„ç†å™¨'); } else { this.addWarning('âš ï¸', 'é›†æˆæµ‹è¯•ç¼ºå°‘äº‹ä»¶å¤„ç†å™¨'); } } else { this.addError('âŒ', 'é›†æˆæµ‹è¯•èœå•é¡¹ç¼ºå¤±'); } } } } addResult(status, message) { this.testResults.push({ status, message, type: 'success' }); console.log(`${status} ${message}`); } addError(status, message) { this.errors.push({ status, message, type: 'error' }); console.error(`${status} ${message}`); } addWarning(status, message) { this.warnings.push({ status, message, type: 'warning' }); console.warn(`${status} ${message}`); } generateValidationReport() { console.log('\nğŸ¯ ==========================================='); console.log('ğŸ” é›†æˆç³»ç»ŸéªŒè¯æŠ¥å‘Š'); console.log('==========================================='); const totalTests = this.testResults.length + this.errors.length + this.warnings.length; const successRate = ((this.testResults.length / totalTests) * 100).toFixed(1); console.log(`ğŸ“Š æ€»æµ‹è¯•é¡¹ç›®: ${totalTests}`); console.log(`âœ… æˆåŠŸ: ${this.testResults.length}`); console.log(`âŒ é”™è¯¯: ${this.errors.length}`); console.log(`âš ï¸ è­¦å‘Š: ${this.warnings.length}`); console.log(`ğŸ“ˆ æˆåŠŸç‡: ${successRate}%`); if (this.errors.length === 0) { console.log('\nğŸ‰ æ­å–œï¼æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡ï¼'); console.log('âœ¨ AlingAié›†æˆæ£€æµ‹ç³»ç»Ÿå·²å®Œå…¨ä¿®å¤å¹¶ä¼˜åŒ–'); } else { console.log('\nâš ï¸ å‘ç°ä»¥ä¸‹é—®é¢˜éœ€è¦ä¿®å¤:'); this.errors.forEach(error => { console.error(` ${error.status} ${error.message}`); }); } if (this.warnings.length > 0) { console.log('\nğŸ“ å»ºè®®ä¼˜åŒ–é¡¹ç›®:'); this.warnings.forEach(warning => { console.warn(` ${warning.status} ${warning.message}`); }); } console.log('\nğŸ éªŒè¯å®Œæˆï¼'); console.log('===========================================\n'); // ä¿å­˜éªŒè¯ç»“æœåˆ°å…¨å±€ window.lastValidationReport = { timestamp: new Date().toISOString(), totalTests, successes: this.testResults.length, errors: this.errors.length, warnings: this.warnings.length, successRate: parseFloat(successRate), details: { results: this.testResults, errors: this.errors, warnings: this.warnings } }; } } // è‡ªåŠ¨å¯åŠ¨éªŒè¯å™¨ window.systemValidator = new IntegratedSystemValidator(); console.log('âœ… é›†æˆç³»ç»ŸéªŒè¯å™¨å·²åŠ è½½'); 