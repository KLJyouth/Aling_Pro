class IntegratedDetectionValidator{constructor(){this.testResults=[];this.passedTests=0;this.failedTests=0;}async runAllValidations(){console.log('â”'.repeat(60));const validations=[()=> this.validateSystemInitialization(),()=> this.validateCoreDetectionEngine(),()=> this.validateExportFunctions(),()=> this.validateModalFunctions(),()=> this.validateLogManagement(),()=> this.validateKeyboardShortcuts(),()=> this.validateUIUpdates(),()=> this.validateCustomDetection(),()=> this.validateErrorHandling()];for(const validation of validations){try{await validation();}catch(error){this.recordResult('éªŒè¯å¼‚å¸¸',false,error.message);}await this.delay(500);}this.showValidationResults();}async validateSystemInitialization(){this.recordResult('æ£€æµ‹ç³»ç»Ÿå¯¹è±¡å­˜åœ¨',typeof window.detectionSystem !=='undefined',window.detectionSystem ? 'ç³»ç»Ÿå¯¹è±¡å·²åˆ›å»º' : 'ç³»ç»Ÿå¯¹è±¡æœªåˆ›å»º');this.recordResult('åˆå§‹åŒ–å‡½æ•°å¯ç”¨',typeof window.initializeDetectionSystem==='function','åˆå§‹åŒ–å‡½æ•°æ­£å¸¸');const requiredElements=[ 'progressCircle','progressText','totalTestsCount','logConsole','completedTestsCount','passedTestsCount' ];for(const elementId of requiredElements){this.recordResult(`HTMLå…ƒç´ å­˜åœ¨: ${elementId}`,document.getElementById(elementId)!==null,`å…ƒç´  ${elementId}çŠ¶æ€`);}}async validateCoreDetectionEngine(){if(!window.detectionSystem){this.recordResult('æ ¸å¿ƒå¼•æ“éªŒè¯',false,'æ£€æµ‹ç³»ç»Ÿæœªåˆå§‹åŒ–');return;}const system=window.detectionSystem;const coreMethods=[ 'runFullDetection','runQuickDetection','runCustomDetection','startDetection','completeDetection','clearResults','updateProgress','updateSummaryStats','addLog' ];for(const method of coreMethods){this.recordResult(`æ ¸å¿ƒæ–¹æ³•: ${method}`,typeof system[method]==='function',`æ–¹æ³• ${method}å¯ç”¨æ€§`);}this.recordResult('æµ‹è¯•åˆ†ç±»é…ç½®',system.testCategories && Object.keys(system.testCategories).length > 0,`é…ç½®äº† ${Object.keys(system.testCategories ||{}).length}ä¸ªæµ‹è¯•åˆ†ç±»`);this.recordResult('æµ‹è¯•æ€»æ•°è®¡ç®—',system.totalTests > 0,`æ€»è®¡ ${system.totalTests}ä¸ªæµ‹è¯•é¡¹ç›®`);}async validateExportFunctions(){const exportFunctions=[ 'exportResults','exportJSON','exportCSV','exportPDF' ];for(const func of exportFunctions){this.recordResult(`å¯¼å‡ºå‡½æ•°: ${func}`,typeof window[func]==='function',`å‡½æ•° ${func}å¯ç”¨æ€§`);}if(window.detectionSystem){const system=window.detectionSystem;this.recordResult('CSVæ•°æ®ç”Ÿæˆ',typeof system.generateCSVData==='function','CSVæ•°æ®ç”Ÿæˆæ–¹æ³•å¯ç”¨');this.recordResult('PDFåº“åŠ è½½',typeof system.loadJsPDF==='function','PDFåº“åŠ è½½æ–¹æ³•å¯ç”¨');this.recordResult('JSONä¸‹è½½',typeof system.downloadJSON==='function','JSONä¸‹è½½æ–¹æ³•å¯ç”¨');}}async validateModalFunctions(){if(!window.detectionSystem){this.recordResult('æ¨¡æ€æ¡†éªŒè¯',false,'æ£€æµ‹ç³»ç»Ÿæœªåˆå§‹åŒ–');return;}const system=window.detectionSystem;const modalMethods=[ 'showSystemInfo','showCustomDetectionModal','collectSystemInfo','displaySystemInfoModal','generateCustomDetectionOptions' ];for(const method of modalMethods){this.recordResult(`æ¨¡æ€æ¡†æ–¹æ³•: ${method}`,typeof system[method]==='function',`æ–¹æ³• ${method}å¯ç”¨æ€§`);}this.recordResult('Bootstrapæ¨¡æ€æ¡†',typeof window.bootstrap !=='undefined' && typeof bootstrap.Modal==='function','Bootstrapæ¨¡æ€æ¡†æ”¯æŒ');}async validateLogManagement(){const logFunctions=[ 'logInfo','logSuccess','logWarning','logError','clearLog','toggleAutoScroll','exportLog' ];for(const func of logFunctions){this.recordResult(`æ—¥å¿—å‡½æ•°: ${func}`,typeof window[func]==='function',`å‡½æ•° ${func}å¯ç”¨æ€§`);}const logConsole=document.getElementById('logConsole');this.recordResult('æ—¥å¿—å®¹å™¨å­˜åœ¨',logConsole !==null,'æ—¥å¿—æ˜¾ç¤ºå®¹å™¨çŠ¶æ€');if(logConsole){this.recordResult('è‡ªåŠ¨æ»šåŠ¨å±æ€§',logConsole.hasAttribute('data-auto-scroll')|| logConsole.getAttribute('data-auto-scroll')!==null,'è‡ªåŠ¨æ»šåŠ¨é…ç½®');}}async validateKeyboardShortcuts(){const shortcutFunctions=[ 'runQuickDetection','runFullDetection','clearResults','exportResults' ];for(const func of shortcutFunctions){this.recordResult(`å¿«æ·é”®å‡½æ•°: ${func}`,typeof window[func]==='function',`å¿«æ·é”®å¯¹åº”å‡½æ•° ${func}å¯ç”¨æ€§`);}try{const testEvent=new KeyboardEvent('keydown',{ctrlKey: true,key: 'r'});this.recordResult('é”®ç›˜äº‹ä»¶åˆ›å»º',testEvent instanceof KeyboardEvent,'å¯ä»¥åˆ›å»ºé”®ç›˜äº‹ä»¶å¯¹è±¡');}catch(error){this.recordResult('é”®ç›˜äº‹ä»¶åˆ›å»º',false,`é”®ç›˜äº‹ä»¶åˆ›å»ºå¤±è´¥: ${error.message}`);}}async validateUIUpdates(){if(!window.detectionSystem){this.recordResult('UIæ›´æ–°éªŒè¯',false,'æ£€æµ‹ç³»ç»Ÿæœªåˆå§‹åŒ–');return;}const system=window.detectionSystem;const uiMethods=[ 'updateProgress','updateSummaryStats','updateCategoryStatus','updateTestStatus','updateControlButtons','updateLastUpdate' ];for(const method of uiMethods){this.recordResult(`UIæ›´æ–°æ–¹æ³•: ${method}`,typeof system[method]==='function',`æ–¹æ³• ${method}å¯ç”¨æ€§`);}try{system.updateProgress(50);const progressText=document.getElementById('progressText');this.recordResult('è¿›åº¦æ›´æ–°æµ‹è¯•',progressText && progressText.textContent.includes('50'),'è¿›åº¦æ˜¾ç¤ºæ›´æ–°æ­£å¸¸');}catch(error){this.recordResult('è¿›åº¦æ›´æ–°æµ‹è¯•',false,`è¿›åº¦æ›´æ–°å¤±è´¥: ${error.message}`);}}async validateCustomDetection(){if(!window.detectionSystem){this.recordResult('è‡ªå®šä¹‰æ£€æµ‹éªŒè¯',false,'æ£€æµ‹ç³»ç»Ÿæœªåˆå§‹åŒ–');return;}const system=window.detectionSystem;const customMethods=[ 'selectAllTests','clearAllTests','runSelectedTests','attachCustomModalEvents','updateSelectedCount','updateCategoryCheckboxes','runCustomDetectionTests' ];for(const method of customMethods){this.recordResult(`è‡ªå®šä¹‰æ£€æµ‹æ–¹æ³•: ${method}`,typeof system[method]==='function',`æ–¹æ³• ${method}å¯ç”¨æ€§`);}this.recordResult('æµ‹è¯•åç§°æ˜ å°„',typeof system.getTestDisplayName==='function','æµ‹è¯•åç§°æ˜ å°„æ–¹æ³•å¯ç”¨');if(typeof system.getTestDisplayName==='function'){const testName=system.getTestDisplayName('serverHealth');this.recordResult('æµ‹è¯•åç§°æ˜ å°„åŠŸèƒ½',testName && testName !=='serverHealth',`æ˜ å°„ç»“æœ: ${testName}`);}}async validateErrorHandling(){if(!window.detectionSystem){this.recordResult('é”™è¯¯å¤„ç†éªŒè¯',false,'æ£€æµ‹ç³»ç»Ÿæœªåˆå§‹åŒ–');return;}const system=window.detectionSystem;try{system.logError('æµ‹è¯•é”™è¯¯æ¶ˆæ¯');this.recordResult('é”™è¯¯æ—¥å¿—è®°å½•',true,'é”™è¯¯æ—¥å¿—è®°å½•æ­£å¸¸');}catch(error){this.recordResult('é”™è¯¯æ—¥å¿—è®°å½•',false,`é”™è¯¯æ—¥å¿—è®°å½•å¤±è´¥: ${error.message}`);}try{system.updateProgress(null);this.recordResult('è¿›åº¦æ›´æ–°é”™è¯¯å¤„ç†',true,'è¿›åº¦æ›´æ–°é”™è¯¯å¤„ç†æ­£å¸¸');}catch(error){this.recordResult('è¿›åº¦æ›´æ–°é”™è¯¯å¤„ç†',false,`è¿›åº¦æ›´æ–°é”™è¯¯å¤„ç†å¤±è´¥: ${error.message}`);}try{system.updateTestStatus('non-existent-test','success');this.recordResult('ä¸å­˜åœ¨å…ƒç´ å¤„ç†',true,'ä¸å­˜åœ¨å…ƒç´ å¤„ç†æ­£å¸¸');}catch(error){this.recordResult('ä¸å­˜åœ¨å…ƒç´ å¤„ç†',false,`ä¸å­˜åœ¨å…ƒç´ å¤„ç†å¤±è´¥: ${error.message}`);}}recordResult(testName,passed,message){this.testResults.push({name: testName,passed: passed,message: message,timestamp: new Date().toISOString()});if(passed){this.passedTests++;}else{this.failedTests++;}}showValidationResults(){console.log('â”'.repeat(60));const successRate=((this.passedTests/this.testResults.length)*100).toFixed(1);if(this.failedTests > 0){this.testResults .filter(result=> !result.passed).forEach(result=>{});}if(successRate >=95){}else if(successRate >=85){}else if(successRate >=70){}else{}this.exportValidationReport();}exportValidationReport(){const report={timestamp: new Date().toISOString(),summary:{totalTests: this.testResults.length,passedTests: this.passedTests,failedTests: this.failedTests,successRate:((this.passedTests/this.testResults.length)*100).toFixed(1)+'%'},details: this.testResults,recommendations: this.generateRecommendations()};if(typeof document !=='undefined'){const blob=new Blob([JSON.stringify(report,null,2)],{type: 'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`integrated-detection-validation-${Date.now()}.json`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);}return report;}generateRecommendations(){const recommendations=[];if(this.failedTests > 0){recommendations.push('æ£€æŸ¥å¹¶ä¿®å¤å¤±è´¥çš„éªŒè¯é¡¹ç›®');}if(this.passedTests/this.testResults.length < 0.9){recommendations.push('å»ºè®®è¿›è¡Œæ›´å…¨é¢çš„åŠŸèƒ½æµ‹è¯•');}recommendations.push('å®šæœŸè¿è¡ŒéªŒè¯ä»¥ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§');recommendations.push('åœ¨æ–°åŠŸèƒ½å¼€å‘åé‡æ–°è¿è¡ŒéªŒè¯');return recommendations;}delay(ms){return new Promise(resolve=> setTimeout(resolve,ms));}}window.detectionValidator=new IntegratedDetectionValidator();window.validateDetectionSystem=()=>{return window.detectionValidator.runAllValidations();};if(typeof document !=='undefined'){document.addEventListener('DOMContentLoaded',()=>{setTimeout(()=>{console.log('ğŸ’¡ è¾“å…¥ validateDetectionSystem()å¼€å§‹éªŒè¯');console.log('ğŸ’¡ è¾“å…¥ detectionValidator.runAllValidations()è¿è¡Œå®Œæ•´éªŒè¯');},3000);});}