<?php

/**
 * AlingAi Pro 5.0 - security.php Configuration
 * Generated by ConfigurationOptimizer
 * Created: 2025-06-11 16:36:06
 */

return [
    /*
    |--------------------------------------------------------------------------
    | èº«ä»½éªŒè¯
    |--------------------------------------------------------------------------
    */
    'auth' => [
        // å¯†ç å“ˆå¸Œé€‰é¡¹
        'password_hash' => [
            'algorithm' => PASSWORD_BCRYPT,
            'options' => [
                'cost' => 12, // å“ˆå¸Œè®¡ç®—å¤æ‚åº¦ï¼Œè¶Šé«˜è¶Šå®‰å…¨ä½†æ€§èƒ½æ¶ˆè€—è¶Šå¤?            ], 
        ], 
        
        // ä»¤ç‰Œè®¾ç½®
        'tokens' => [
            'lifetime' => 3600, // ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
            'refresh_lifetime' => 86400, // åˆ·æ–°ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
            'algorithm' => 'HS256', // JWTç­¾åç®—æ³•
        ], 
        
        // ç™»å½•å°è¯•é™åˆ¶
        'throttle' => [
            'enabled' => true,
            'max_attempts' => 5, // æœ€å¤§å°è¯•æ¬¡æ•?            'decay_minutes' => 10, // é”å®šæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
        ], 
        
        // è®¤è¯é…ç½®
        'enable_2fa' => (bool)($_ENV['ENABLE_2FA'] ?? false],
        'session_lifetime' => (int)($_ENV['SESSION_LIFETIME'] ?? 3600], // é»˜è®¤1å°æ—¶
        'max_login_attempts' => (int)($_ENV['MAX_LOGIN_ATTEMPTS'] ?? 5],
        'lockout_time' => (int)($_ENV['LOCKOUT_TIME'] ?? 900], // é»˜è®¤15åˆ†é’Ÿ
        'remember_me_lifetime' => (int)($_ENV['REMEMBER_ME_LIFETIME'] ?? 2592000], // é»˜è®¤30å¤?        'secure_cookies' => (bool)($_ENV['SECURE_COOKIES'] ?? true],
        'api_rate_limit' => (int)($_ENV['API_RATE_LIMIT'] ?? 60], // æ¯åˆ†é’Ÿè¯·æ±‚æ•°
    ], 
    
    /*
    |--------------------------------------------------------------------------
    | ä¼šè¯å®‰å…¨
    |--------------------------------------------------------------------------
    */
    'session' => [
        'secure' => true, // ä»…é€šè¿‡HTTPSå‘é€cookie
        'http_only' => true, // ç¦æ­¢JavaScriptè®¿é—®cookie
        'same_site' => 'lax', // Cookie SameSiteç­–ç•¥
        'lifetime' => 120, // ä¼šè¯ç”Ÿå‘½å‘¨æœŸï¼ˆåˆ†é’Ÿï¼‰
        'regenerate' => true, // å®šæœŸé‡æ–°ç”Ÿæˆä¼šè¯ID
    ], 
    
    /*
    |--------------------------------------------------------------------------
    | CORSè®¾ç½®
    |--------------------------------------------------------------------------
    */
    'cors' => [
        'allowed_origins' => explode(',', $_ENV['CORS_ALLOWED_ORIGINS'] ?? '*'],
        'allowed_methods' => explode(',', $_ENV['CORS_ALLOWED_METHODS'] ?? 'GET,POST,PUT,DELETE,OPTIONS'],
        'allowed_headers' => explode(',', $_ENV['CORS_ALLOWED_HEADERS'] ?? 'Content-Type,Authorization,X-Requested-With'],
        'exposed_headers' => explode(',', $_ENV['CORS_EXPOSED_HEADERS'] ?? ''],
        'max_age' => (int)($_ENV['CORS_MAX_AGE'] ?? 3600],
        'supports_credentials' => (bool)($_ENV['CORS_SUPPORTS_CREDENTIALS'] ?? false],
    ], 
    
    /*
    |--------------------------------------------------------------------------
    | å†…å®¹å®‰å…¨ç­–ç•¥
    |--------------------------------------------------------------------------
    */
    'csp' => [
        'enabled' => (bool)($_ENV['CSP_ENABLED'] ?? true],
        'report_only' => (bool)($_ENV['CSP_REPORT_ONLY'] ?? false],
        'report_uri' => $_ENV['CSP_REPORT_URI'] ?? '/api/v1/security/csp-report',
    ], 
    
    /*
    |--------------------------------------------------------------------------
    | XSSé˜²æŠ¤
    |--------------------------------------------------------------------------
    */
    'xss' => [
        'enabled' => true,
        'mode' => 'block', // 'block' æˆ?'filter'
    ], 
    
    /*
    |--------------------------------------------------------------------------
    | CSRFé˜²æŠ¤
    |--------------------------------------------------------------------------
    */
    'csrf' => [
        'enabled' => true,
        'exclude_routes' => [
            'api/public/*', // æŽ’é™¤å…¬å¼€API
        ], 
    ], 
    
    /*
    |--------------------------------------------------------------------------
    | æ–‡ä»¶ä¸Šä¼ å®‰å…¨
    |--------------------------------------------------------------------------
    */
    'uploads' => [
        'max_size' => 10485760, // æœ€å¤§ä¸Šä¼ å¤§å°ï¼ˆå­—èŠ‚ï¼?        'allowed_types' => [
            'image/jpeg',
            'image/png',
            'image/gif',
            'application/pdf',
            'application/msword',
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
            'text/plain',
        ], 
        'disallowed_extensions' => [
            'php', 'phtml', 'php3', 'php4', 'php5', 'php7', 'pht', 'phar', 'exe', 'sh', 'bat', 'cmd',
        ], 
        'scan_files' => true, // æ‰«æä¸Šä¼ æ–‡ä»¶æ˜¯å¦åŒ…å«æ¶æ„ä»£ç 
    ], 
    
    /*
    |--------------------------------------------------------------------------
    | æ—¥å¿—è®°å½•
    |--------------------------------------------------------------------------
    */
    'logging' => [
        'security_events' => true, // è®°å½•å®‰å…¨ç›¸å…³äº‹ä»¶
        'login_attempts' => true, // è®°å½•ç™»å½•å°è¯•
        'admin_actions' => true, // è®°å½•ç®¡ç†å‘˜æ“ä½?    ], 
    
    // åŠ å¯†é…ç½®
    'encryption' => [
        'enable_quantum_encryption' => (bool)($_ENV['ENABLE_QUANTUM_ENCRYPTION'] ?? false],
        'default_algorithm' => $_ENV['DEFAULT_ENCRYPTION_ALGORITHM'] ?? 'AES-256-GCM',
        'key_rotation_interval' => (int)($_ENV['KEY_ROTATION_INTERVAL'] ?? 86400], // é»˜è®¤24å°æ—¶
        'api_encryption' => (bool)($_ENV['API_ENCRYPTION_ENABLED'] ?? true],
        'api_encryption_algorithm' => $_ENV['API_ENCRYPTION_ALGORITHM'] ?? 'AES-256-CBC',
        'data_encryption' => (bool)($_ENV['DATA_ENCRYPTION_ENABLED'] ?? true],
        'hash_algorithm' => $_ENV['HASH_ALGORITHM'] ?? 'sha256',
    ], 
    
    // JWTé…ç½®
    'jwt' => [
        'secret' => $_ENV['JWT_SECRET'] ?? '',
        'algorithm' => $_ENV['JWT_ALGORITHM'] ?? 'HS256',
        'expires_in' => (int)($_ENV['JWT_EXPIRES_IN'] ?? 3600], // é»˜è®¤1å°æ—¶
        'refresh_expires_in' => (int)($_ENV['JWT_REFRESH_EXPIRES_IN'] ?? 604800], // é»˜è®¤7å¤?    ], 
    
    // ä¸­é—´ä»¶é…ç½?    'middleware' => [
        'api_encryption' => [
            'enabled' => (bool)($_ENV['API_ENCRYPTION_ENABLED'] ?? true],
            'excluded_paths' => explode(',', $_ENV['API_ENCRYPTION_EXCLUDED_PATHS'] ?? '/api/v1/system/info,/api/health'],
            'algorithm' => $_ENV['API_ENCRYPTION_ALGORITHM'] ?? 'AES-256-CBC',
            'debug_mode' => (bool)($_ENV['API_ENCRYPTION_DEBUG'] ?? false],
        ], 
        'authentication' => [
            'public_paths' => explode(',', $_ENV['AUTH_PUBLIC_PATHS'] ?? '/api/v1/system/info,/api/health,/api/auth/login,/api/auth/register'],
            'token_header' => $_ENV['AUTH_TOKEN_HEADER'] ?? 'Authorization',
            'token_prefix' => $_ENV['AUTH_TOKEN_PREFIX'] ?? 'Bearer',
            'session_header' => $_ENV['AUTH_SESSION_HEADER'] ?? 'X-Session-ID',
        ], 
    ], 
    
    // å¯†ç ç­–ç•¥
    'password_policy' => [
        'min_length' => (int)($_ENV['PASSWORD_MIN_LENGTH'] ?? 8],
        'require_uppercase' => (bool)($_ENV['PASSWORD_REQUIRE_UPPERCASE'] ?? true],
        'require_lowercase' => (bool)($_ENV['PASSWORD_REQUIRE_LOWERCASE'] ?? true],
        'require_number' => (bool)($_ENV['PASSWORD_REQUIRE_NUMBER'] ?? true],
        'require_special' => (bool)($_ENV['PASSWORD_REQUIRE_SPECIAL'] ?? false],
        'expiry_days' => (int)($_ENV['PASSWORD_EXPIRY_DAYS'] ?? 90],
    ], 
];
