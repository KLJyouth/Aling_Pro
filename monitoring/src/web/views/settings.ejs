<!-- 设置选项卡 -->
<ul class="nav nav-tabs mb-4" id="settingsTabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="general-tab" data-bs-toggle="tab" data-bs-target="#general" type="button" role="tab" aria-controls="general" aria-selected="true">
      <i class="bi bi-gear"></i> 常规设置
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="notification-tab" data-bs-toggle="tab" data-bs-target="#notification" type="button" role="tab" aria-controls="notification" aria-selected="false">
      <i class="bi bi-bell"></i> 通知设置
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="storage-tab" data-bs-toggle="tab" data-bs-target="#storage" type="button" role="tab" aria-controls="storage" aria-selected="false">
      <i class="bi bi-database"></i> 存储设置
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="system-tab" data-bs-toggle="tab" data-bs-target="#system" type="button" role="tab" aria-controls="system" aria-selected="false">
      <i class="bi bi-cpu"></i> 系统信息
    </button>
  </li>
</ul>

<!-- 设置内容 -->
<div class="tab-content" id="settingsTabContent">
  <!-- 常规设置 -->
  <div class="tab-pane fade show active" id="general" role="tabpanel" aria-labelledby="general-tab">
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">常规设置</h6>
      </div>
      <div class="card-body">
        <form id="generalSettingsForm">
          <div class="mb-3">
            <label for="systemName" class="form-label">系统名称</label>
            <input type="text" class="form-control" id="systemName" value="AlingAi API监控系统">
          </div>
          <div class="mb-3">
            <label for="defaultCheckInterval" class="form-label">默认检查间隔（秒）</label>
            <input type="number" class="form-control" id="defaultCheckInterval" value="300">
          </div>
          <div class="mb-3">
            <label for="defaultTimeout" class="form-label">默认超时时间（毫秒）</label>
            <input type="number" class="form-control" id="defaultTimeout" value="5000">
          </div>
          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="enableDebugMode">
            <label class="form-check-label" for="enableDebugMode">启用调试模式</label>
          </div>
          <button type="button" class="btn btn-primary" id="saveGeneralSettings">保存设置</button>
        </form>
      </div>
    </div>
  </div>
  
  <!-- 通知设置 -->
  <div class="tab-pane fade" id="notification" role="tabpanel" aria-labelledby="notification-tab">
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">通知设置</h6>
      </div>
      <div class="card-body">
        <form id="notificationSettingsForm">
          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="enableEmailNotifications" checked>
            <label class="form-check-label" for="enableEmailNotifications">启用邮件通知</label>
          </div>
          
          <div class="mb-3">
            <label for="emailServer" class="form-label">SMTP服务器</label>
            <input type="text" class="form-control" id="emailServer" value="smtp.example.com">
          </div>
          
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="emailPort" class="form-label">SMTP端口</label>
              <input type="number" class="form-control" id="emailPort" value="587">
            </div>
            <div class="col-md-6">
              <label for="emailSecurity" class="form-label">安全连接</label>
              <select class="form-select" id="emailSecurity">
                <option value="tls" selected>TLS</option>
                <option value="ssl">SSL</option>
                <option value="none">无</option>
              </select>
            </div>
          </div>
          
          <div class="mb-3">
            <label for="emailUsername" class="form-label">用户名</label>
            <input type="text" class="form-control" id="emailUsername" value="notifications@example.com">
          </div>
          
          <div class="mb-3">
            <label for="emailPassword" class="form-label">密码</label>
            <input type="password" class="form-control" id="emailPassword" value="********">
          </div>
          
          <div class="mb-3">
            <label for="emailRecipients" class="form-label">收件人（多个地址用逗号分隔）</label>
            <input type="text" class="form-control" id="emailRecipients" value="admin@example.com">
          </div>
          
          <hr>
          
          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="enableWebhooks">
            <label class="form-check-label" for="enableWebhooks">启用Webhook通知</label>
          </div>
          
          <div class="mb-3">
            <label for="webhookUrl" class="form-label">Webhook URL</label>
            <input type="url" class="form-control" id="webhookUrl" placeholder="https://example.com/webhook">
          </div>
          
          <button type="button" class="btn btn-primary" id="saveNotificationSettings">保存设置</button>
          <button type="button" class="btn btn-secondary" id="testNotification">测试通知</button>
        </form>
      </div>
    </div>
  </div>
  
  <!-- 存储设置 -->
  <div class="tab-pane fade" id="storage" role="tabpanel" aria-labelledby="storage-tab">
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">存储设置</h6>
      </div>
      <div class="card-body">
        <form id="storageSettingsForm">
          <div class="mb-3">
            <label for="dataRetention" class="form-label">数据保留期（天）</label>
            <input type="number" class="form-control" id="dataRetention" value="90">
            <div class="form-text">设置为0表示永久保留</div>
          </div>
          
          <div class="mb-3">
            <label for="dbType" class="form-label">数据库类型</label>
            <select class="form-select" id="dbType">
              <option value="sqlite" selected>SQLite</option>
              <option value="mysql">MySQL</option>
              <option value="postgres">PostgreSQL</option>
              <option value="mongodb">MongoDB</option>
            </select>
          </div>
          
          <div class="mb-3">
            <label for="dbConnection" class="form-label">连接字符串</label>
            <input type="text" class="form-control" id="dbConnection" value="./data/monitoring.db">
          </div>
          
          <button type="button" class="btn btn-primary" id="saveStorageSettings">保存设置</button>
          <button type="button" class="btn btn-danger" id="clearData">清除所有数据</button>
        </form>
      </div>
    </div>
  </div>
  
  <!-- 系统信息 -->
  <div class="tab-pane fade" id="system" role="tabpanel" aria-labelledby="system-tab">
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">系统信息</h6>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-bordered">
            <tbody>
              <tr>
                <th style="width: 30%">版本</th>
                <td id="systemVersion">1.0.0</td>
              </tr>
              <tr>
                <th>Node.js版本</th>
                <td id="nodeVersion">v16.15.0</td>
              </tr>
              <tr>
                <th>操作系统</th>
                <td id="osInfo">Windows 10 x64</td>
              </tr>
              <tr>
                <th>内存使用</th>
                <td id="memoryUsageInfo">1024 MB / 8192 MB</td>
              </tr>
              <tr>
                <th>运行时间</th>
                <td id="uptimeInfo">3天 5小时 22分钟</td>
              </tr>
              <tr>
                <th>数据库大小</th>
                <td id="dbSizeInfo">12.5 MB</td>
              </tr>
              <tr>
                <th>监控API数量</th>
                <td id="apiCountInfo">12</td>
              </tr>
              <tr>
                <th>存储的指标数</th>
                <td id="metricsCountInfo">36,542</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div class="d-flex justify-content-end mt-3">
          <button type="button" class="btn btn-primary" id="refreshSystemInfo">
            <i class="bi bi-arrow-clockwise"></i> 刷新信息
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 确认清除数据模态框 -->
<div class="modal fade" id="clearDataModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">确认清除数据</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-danger">
          <i class="bi bi-exclamation-triangle"></i> 警告：此操作将永久删除所有监控数据，包括API配置、指标和告警历史记录。此操作无法撤销！
        </div>
        <p>请输入"DELETE"以确认：</p>
        <input type="text" class="form-control" id="deleteConfirmation">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
        <button type="button" class="btn btn-danger" id="confirmClearData" disabled>确认清除</button>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // 保存常规设置
    document.getElementById('saveGeneralSettings').addEventListener('click', function() {
      alert('设置已保存');
    });
    
    // 保存通知设置
    document.getElementById('saveNotificationSettings').addEventListener('click', function() {
      alert('通知设置已保存');
    });
    
    // 测试通知
    document.getElementById('testNotification').addEventListener('click', function() {
      alert('测试通知已发送');
    });
    
    // 保存存储设置
    document.getElementById('saveStorageSettings').addEventListener('click', function() {
      alert('存储设置已保存');
    });
    
    // 清除数据
    document.getElementById('clearData').addEventListener('click', function() {
      const modal = new bootstrap.Modal(document.getElementById('clearDataModal'));
      modal.show();
    });
    
    // 刷新系统信息
    document.getElementById('refreshSystemInfo').addEventListener('click', function() {
      alert('系统信息已刷新');
    });
    
    // 删除确认输入验证
    document.getElementById('deleteConfirmation').addEventListener('input', function() {
      document.getElementById('confirmClearData').disabled = this.value !== 'DELETE';
    });
    
    // 确认清除数据
    document.getElementById('confirmClearData').addEventListener('click', function() {
      alert('所有数据已清除');
      const modal = bootstrap.Modal.getInstance(document.getElementById('clearDataModal'));
      modal.hide();
    });
  });
</script> 