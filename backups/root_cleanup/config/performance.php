<?php

/**
 * AlingAi Pro 5.0 - performance.php Configuration
 * Generated by ConfigurationOptimizer
 * Created: 2025-06-11 16:36:06
 */

return [
    /*
    |--------------------------------------------------------------------------
    | 缓存设置
    |--------------------------------------------------------------------------
    */
    'cache' => [
        'driver' => env('CACHE_DRIVER', 'file'), // 可选: file, redis, array
        'prefix' => 'alingai_cache_',
        'ttl' => 3600, // 默认缓存生存时间（秒）
        
        // 文件缓存配置
        'file' => [
            'path' => storage_path('cache'),
        ],
        
        // Redis缓存配置
        'redis' => [
            'host' => env('REDIS_HOST', '127.0.0.1'),
            'port' => env('REDIS_PORT', 6379),
            'password' => env('REDIS_PASSWORD', null),
            'database' => env('REDIS_CACHE_DB', 1),
        ],
        
        // 缓存标签
        'tags' => [
            'users' => 600, // 用户数据缓存时间
            'settings' => 3600, // 设置缓存时间
            'api' => 60, // API响应缓存时间
        ],
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 查询优化
    |--------------------------------------------------------------------------
    */
    'database' => [
        'query_cache' => true, // 是否缓存查询结果
        'query_cache_ttl' => 300, // 查询缓存生存时间（秒）
        'slow_query_threshold' => 1.0, // 慢查询阈值（秒）
        'log_slow_queries' => true, // 是否记录慢查询
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 路由优化
    |--------------------------------------------------------------------------
    */
    'routing' => [
        'cache' => true, // 是否缓存路由
        'cache_ttl' => 86400, // 路由缓存生存时间（秒）
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 视图优化
    |--------------------------------------------------------------------------
    */
    'views' => [
        'cache' => true, // 是否缓存视图
        'minify_html' => true, // 是否压缩HTML输出
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 静态资源优化
    |--------------------------------------------------------------------------
    */
    'assets' => [
        'combine_css' => true, // 合并CSS文件
        'combine_js' => true, // 合并JavaScript文件
        'minify_css' => true, // 压缩CSS
        'minify_js' => true, // 压缩JavaScript
        'cache_busting' => true, // 使用缓存破坏技术（添加版本号）
        'gzip_static' => true, // 使用预压缩的静态文件
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 会话优化
    |--------------------------------------------------------------------------
    */
    'session' => [
        'driver' => 'file', // 会话存储驱动
        'lifetime' => 120, // 会话生命周期（分钟）
        'expire_on_close' => false, // 关闭浏览器时会话是否过期
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 内存优化
    |--------------------------------------------------------------------------
    */
    'memory' => [
        'limit' => '256M', // 内存限制
        'gc_probability' => 1, // 垃圾回收概率分子
        'gc_divisor' => 100, // 垃圾回收概率分母
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 日志优化
    |--------------------------------------------------------------------------
    */
    'logging' => [
        'level' => 'error', // 日志级别：debug, info, warning, error, critical
        'rotate' => true, // 是否轮转日志
        'max_files' => 7, // 保留的日志文件数量
    ],
    
    /*
    |--------------------------------------------------------------------------
    | API优化
    |--------------------------------------------------------------------------
    */
    'api' => [
        'throttle' => [
            'enabled' => true, // 是否启用API限流
            'max_attempts' => 60, // 最大请求次数
            'decay_minutes' => 1, // 限流时间窗口（分钟）
        ],
        'cache_responses' => true, // 是否缓存API响应
        'cache_ttl' => 60, // API响应缓存生存时间（秒）
    ],
];
